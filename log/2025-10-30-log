D:\VoiceRecognition\VoiceprintRecognition-Pytorch\venv\Scripts\python.exe D:\Project\VisDrone_Experiment\run_ablation_study.py
✅ 所有路径验证通过
🧪 VisDrone目标检测消融实验
============================================================
🧪 开始消融实验
============================================================
实验顺序:
- baseline: 原始YOLOv8s
- ema: YOLOv8s + EMA注意力
- bifpn: YOLOv8s + BiFPN
- full: YOLOv8s + EMA + BiFPN
============================================================

🎯 实验 baseline: 原始YOLOv8s
--------------------------------------------------
开始训练...
Ultralytics 8.3.146  Python-3.9.13 torch-2.2.2+cu118 CUDA:0 (NVIDIA GeForce RTX 3060, 12288MiB)
engine\trainer: agnostic_nms=False, amp=True, augment=False, auto_augment=randaugment, batch=16, bgr=0.0, box=7.5, cache=False, cfg=None, classes=None, close_mosaic=10, cls=0.5, conf=None, copy_paste=0.0, copy_paste_mode=flip, cos_lr=False, cutmix=0.0, data=D:\Project\VisDrone_Experiment\configs\dataset\visdrone.yaml, degrees=0.0, deterministic=True, device=0, dfl=1.5, dnn=False, dropout=0.0, dynamic=False, embed=None, epochs=80, erasing=0.4, exist_ok=True, fliplr=0.5, flipud=0.0, format=torchscript, fraction=1.0, freeze=None, half=False, hsv_h=0.015, hsv_s=0.7, hsv_v=0.4, imgsz=640, int8=False, iou=0.7, keras=False, kobj=1.0, line_width=None, lr0=0.01, lrf=0.01, mask_ratio=4, max_det=300, mixup=0.0, mode=train, model=scripts/yolov8s.pt, momentum=0.937, mosaic=1.0, multi_scale=False, name=baseline, nbs=64, nms=False, opset=None, optimize=False, optimizer=auto, overlap_mask=True, patience=20, perspective=0.0, plots=True, pose=12.0, pretrained=True, profile=False, project=D:\Project\VisDrone_Experiment\runs, rect=False, resume=False, retina_masks=False, save=True, save_conf=False, save_crop=False, save_dir=D:\Project\VisDrone_Experiment\runs\baseline, save_frames=False, save_json=False, save_period=-1, save_txt=False, scale=0.5, seed=0, shear=0.0, show=False, show_boxes=True, show_conf=True, show_labels=True, simplify=True, single_cls=False, source=None, split=val, stream_buffer=False, task=detect, time=None, tracker=botsort.yaml, translate=0.1, val=True, verbose=False, vid_stride=1, visualize=False, warmup_bias_lr=0.1, warmup_epochs=3.0, warmup_momentum=0.8, weight_decay=0.0005, workers=4, workspace=None
Overriding model.yaml nc=80 with nc=10

                   from  n    params  module                                       arguments
  0                  -1  1       928  ultralytics.nn.modules.conv.Conv             [3, 32, 3, 2]
  1                  -1  1     18560  ultralytics.nn.modules.conv.Conv             [32, 64, 3, 2]
  2                  -1  1     29056  ultralytics.nn.modules.block.C2f             [64, 64, 1, True]
  3                  -1  1     73984  ultralytics.nn.modules.conv.Conv             [64, 128, 3, 2]
  4                  -1  2    197632  ultralytics.nn.modules.block.C2f             [128, 128, 2, True]
  5                  -1  1    295424  ultralytics.nn.modules.conv.Conv             [128, 256, 3, 2]
  6                  -1  2    788480  ultralytics.nn.modules.block.C2f             [256, 256, 2, True]
  7                  -1  1   1180672  ultralytics.nn.modules.conv.Conv             [256, 512, 3, 2]
  8                  -1  1   1838080  ultralytics.nn.modules.block.C2f             [512, 512, 1, True]
  9                  -1  1    656896  ultralytics.nn.modules.block.SPPF            [512, 512, 5]
 10                  -1  1         0  torch.nn.modules.upsampling.Upsample         [None, 2, 'nearest']
 11             [-1, 6]  1         0  ultralytics.nn.modules.conv.Concat           [1]
 12                  -1  1    591360  ultralytics.nn.modules.block.C2f             [768, 256, 1]
 13                  -1  1         0  torch.nn.modules.upsampling.Upsample         [None, 2, 'nearest']
 14             [-1, 4]  1         0  ultralytics.nn.modules.conv.Concat           [1]
 15                  -1  1    148224  ultralytics.nn.modules.block.C2f             [384, 128, 1]
 16                  -1  1    147712  ultralytics.nn.modules.conv.Conv             [128, 128, 3, 2]
 17            [-1, 12]  1         0  ultralytics.nn.modules.conv.Concat           [1]
 18                  -1  1    493056  ultralytics.nn.modules.block.C2f             [384, 256, 1]
 19                  -1  1    590336  ultralytics.nn.modules.conv.Conv             [256, 256, 3, 2]
 20             [-1, 9]  1         0  ultralytics.nn.modules.conv.Concat           [1]
 21                  -1  1   1969152  ultralytics.nn.modules.block.C2f             [768, 512, 1]
 22        [15, 18, 21]  1   2119918  ultralytics.nn.modules.head.Detect           [10, [128, 256, 512]]
Model summary: 129 layers, 11,139,470 parameters, 11,139,454 gradients, 28.7 GFLOPs

Transferred 349/355 items from pretrained weights
Freezing layer 'model.22.dfl.conv.weight'
AMP: running Automatic Mixed Precision (AMP) checks...
Downloading https://github.com/ultralytics/assets/releases/download/v8.3.0/yolo11n.pt to 'yolo11n.pt'...
100%|██████████| 5.35M/5.35M [00:01<00:00, 4.71MB/s]
AMP: checks passed
train: Fast image access  (ping: 0.20.1 ms, read: 669.6557.9 MB/s, size: 261.9 KB)
train: Scanning D:\Project\VisDrone_Experiment\VisDrone2019-DET\labels\train... 6471 images, 0 backgrounds, 0 corrupt: 100%|██████████| 6471/6471 [00:02<00:00, 2648.63it/s]
train: D:\Project\VisDrone_Experiment\VisDrone2019-DET\images\train\0000137_02220_d_0000163.jpg: 1 duplicate labels removed
train: D:\Project\VisDrone_Experiment\VisDrone2019-DET\images\train\0000140_00118_d_0000002.jpg: 1 duplicate labels removed
train: D:\Project\VisDrone_Experiment\VisDrone2019-DET\images\train\9999945_00000_d_0000114.jpg: 1 duplicate labels removed
train: D:\Project\VisDrone_Experiment\VisDrone2019-DET\images\train\9999987_00000_d_0000049.jpg: 1 duplicate labels removed
train: New cache created: D:\Project\VisDrone_Experiment\VisDrone2019-DET\labels\train.cache
val: Fast image access  (ping: 0.20.1 ms, read: 370.633.5 MB/s, size: 131.6 KB)
val: Scanning D:\Project\VisDrone_Experiment\VisDrone2019-DET\labels\val... 548 images, 0 backgrounds, 0 corrupt: 100%|██████████| 548/548 [00:00<00:00, 1961.65it/s]
val: New cache created: D:\Project\VisDrone_Experiment\VisDrone2019-DET\labels\val.cache
Plotting labels to D:\Project\VisDrone_Experiment\runs\baseline\labels.jpg...
optimizer: 'optimizer=auto' found, ignoring 'lr0=0.01' and 'momentum=0.937' and determining best 'optimizer', 'lr0' and 'momentum' automatically...
optimizer: AdamW(lr=0.000714, momentum=0.9) with parameter groups 57 weight(decay=0.0), 64 weight(decay=0.0005), 63 bias(decay=0.0)
Image sizes 640 train, 640 val
Using 4 dataloader workers
Logging results to D:\Project\VisDrone_Experiment\runs\baseline
Starting training for 80 epochs...

      Epoch    GPU_mem   box_loss   cls_loss   dfl_loss  Instances       Size
       1/80      10.7G      1.567      1.713     0.9978        674        640: 100%|██████████| 405/405 [01:37<00:00,  4.14it/s]
                 Class     Images  Instances      Box(P          R      mAP50  mAP50-95): 100%|██████████| 18/18 [00:04<00:00,  3.81it/s]
                   all        548      38759      0.316      0.256      0.235      0.134

      Epoch    GPU_mem   box_loss   cls_loss   dfl_loss  Instances       Size
       2/80        10G      1.482      1.201     0.9536        872        640: 100%|██████████| 405/405 [01:34<00:00,  4.27it/s]
                 Class     Images  Instances      Box(P          R      mAP50  mAP50-95): 100%|██████████| 18/18 [00:04<00:00,  4.03it/s]
                   all        548      38759      0.352       0.26      0.243      0.139
  0%|          | 0/405 [00:00<?, ?it/s]
      Epoch    GPU_mem   box_loss   cls_loss   dfl_loss  Instances       Size
       3/80      11.7G      1.463      1.163     0.9503        409        640: 100%|██████████| 405/405 [01:34<00:00,  4.30it/s]
                 Class     Images  Instances      Box(P          R      mAP50  mAP50-95): 100%|██████████| 18/18 [00:04<00:00,  4.16it/s]
                   all        548      38759      0.371      0.293      0.271      0.156

      Epoch    GPU_mem   box_loss   cls_loss   dfl_loss  Instances       Size
       4/80      9.38G      1.448       1.13     0.9425        610        640: 100%|██████████| 405/405 [01:32<00:00,  4.36it/s]
                 Class     Images  Instances      Box(P          R      mAP50  mAP50-95): 100%|██████████| 18/18 [00:04<00:00,  4.20it/s]
                   all        548      38759      0.388      0.301      0.283      0.164
  0%|          | 0/405 [00:00<?, ?it/s]
      Epoch    GPU_mem   box_loss   cls_loss   dfl_loss  Instances       Size
       5/80      8.56G      1.426      1.091     0.9377        591        640: 100%|██████████| 405/405 [01:32<00:00,  4.37it/s]
                 Class     Images  Instances      Box(P          R      mAP50  mAP50-95): 100%|██████████| 18/18 [00:04<00:00,  4.22it/s]
                   all        548      38759      0.413      0.306        0.3      0.172
  0%|          | 0/405 [00:00<?, ?it/s]
      Epoch    GPU_mem   box_loss   cls_loss   dfl_loss  Instances       Size
       6/80      9.25G      1.414      1.072     0.9339        466        640: 100%|██████████| 405/405 [01:33<00:00,  4.35it/s]
                 Class     Images  Instances      Box(P          R      mAP50  mAP50-95): 100%|██████████| 18/18 [00:04<00:00,  4.21it/s]
                   all        548      38759      0.403      0.311        0.3      0.174
  0%|          | 0/405 [00:00<?, ?it/s]
      Epoch    GPU_mem   box_loss   cls_loss   dfl_loss  Instances       Size
       7/80      8.47G      1.398       1.05      0.931        274        640: 100%|██████████| 405/405 [01:32<00:00,  4.36it/s]
                 Class     Images  Instances      Box(P          R      mAP50  mAP50-95): 100%|██████████| 18/18 [00:04<00:00,  4.21it/s]
                   all        548      38759      0.414      0.316      0.309      0.178
  0%|          | 0/405 [00:00<?, ?it/s]
      Epoch    GPU_mem   box_loss   cls_loss   dfl_loss  Instances       Size
       8/80      7.64G      1.382      1.032     0.9253        335        640: 100%|██████████| 405/405 [01:32<00:00,  4.37it/s]
                 Class     Images  Instances      Box(P          R      mAP50  mAP50-95): 100%|██████████| 18/18 [00:04<00:00,  4.16it/s]
                   all        548      38759       0.41      0.335      0.322      0.186
  0%|          | 0/405 [00:00<?, ?it/s]
      Epoch    GPU_mem   box_loss   cls_loss   dfl_loss  Instances       Size
       9/80      10.4G      1.378      1.022     0.9241        646        640: 100%|██████████| 405/405 [7:24:06<00:00, 65.79s/it]
                 Class     Images  Instances      Box(P          R      mAP50  mAP50-95): 100%|██████████| 18/18 [00:04<00:00,  4.04it/s]
                   all        548      38759      0.448      0.322      0.326      0.189
  0%|          | 0/405 [00:00<?, ?it/s]
      Epoch    GPU_mem   box_loss   cls_loss   dfl_loss  Instances       Size
      10/80      10.7G      1.359      1.003     0.9209        634        640: 100%|██████████| 405/405 [01:33<00:00,  4.34it/s]
                 Class     Images  Instances      Box(P          R      mAP50  mAP50-95): 100%|██████████| 18/18 [00:04<00:00,  4.25it/s]
                   all        548      38759      0.429      0.329      0.327      0.189

      Epoch    GPU_mem   box_loss   cls_loss   dfl_loss  Instances       Size
      11/80      9.71G      1.357     0.9957     0.9194        505        640: 100%|██████████| 405/405 [01:33<00:00,  4.35it/s]
                 Class     Images  Instances      Box(P          R      mAP50  mAP50-95): 100%|██████████| 18/18 [00:04<00:00,  4.20it/s]
                   all        548      38759      0.452      0.318      0.325      0.189
  0%|          | 0/405 [00:00<?, ?it/s]
      Epoch    GPU_mem   box_loss   cls_loss   dfl_loss  Instances       Size
      12/80      5.86G      1.344     0.9814     0.9169        629        640: 100%|██████████| 405/405 [01:32<00:00,  4.38it/s]
                 Class     Images  Instances      Box(P          R      mAP50  mAP50-95): 100%|██████████| 18/18 [00:04<00:00,  4.21it/s]
                   all        548      38759      0.461      0.326      0.334      0.194

      Epoch    GPU_mem   box_loss   cls_loss   dfl_loss  Instances       Size
      13/80      8.02G      1.347     0.9754     0.9182        706        640: 100%|██████████| 405/405 [01:33<00:00,  4.35it/s]
                 Class     Images  Instances      Box(P          R      mAP50  mAP50-95): 100%|██████████| 18/18 [00:04<00:00,  4.16it/s]
                   all        548      38759      0.445      0.343      0.341      0.199
  0%|          | 0/405 [00:00<?, ?it/s]
      Epoch    GPU_mem   box_loss   cls_loss   dfl_loss  Instances       Size
      14/80      9.41G      1.336     0.9604     0.9135        475        640: 100%|██████████| 405/405 [01:33<00:00,  4.35it/s]
                 Class     Images  Instances      Box(P          R      mAP50  mAP50-95): 100%|██████████| 18/18 [00:04<00:00,  4.20it/s]
                   all        548      38759      0.452      0.349       0.35      0.205
  0%|          | 0/405 [00:00<?, ?it/s]
      Epoch    GPU_mem   box_loss   cls_loss   dfl_loss  Instances       Size
      15/80      12.3G       1.34     0.9597      0.913        648        640: 100%|██████████| 405/405 [01:36<00:00,  4.22it/s]
                 Class     Images  Instances      Box(P          R      mAP50  mAP50-95): 100%|██████████| 18/18 [00:04<00:00,  3.97it/s]
                   all        548      38759       0.46      0.346      0.352      0.204
  0%|          | 0/405 [00:00<?, ?it/s]
      Epoch    GPU_mem   box_loss   cls_loss   dfl_loss  Instances       Size
      16/80      5.98G      1.329     0.9508       0.91        774        640: 100%|██████████| 405/405 [01:33<00:00,  4.34it/s]
                 Class     Images  Instances      Box(P          R      mAP50  mAP50-95): 100%|██████████| 18/18 [00:04<00:00,  4.07it/s]
                   all        548      38759      0.464      0.341      0.347        0.2
  0%|          | 0/405 [00:00<?, ?it/s]
      Epoch    GPU_mem   box_loss   cls_loss   dfl_loss  Instances       Size
      17/80      6.96G      1.319     0.9416     0.9092        353        640: 100%|██████████| 405/405 [01:32<00:00,  4.36it/s]
                 Class     Images  Instances      Box(P          R      mAP50  mAP50-95): 100%|██████████| 18/18 [00:04<00:00,  4.02it/s]
                   all        548      38759      0.468      0.343      0.351      0.205
  0%|          | 0/405 [00:00<?, ?it/s]
      Epoch    GPU_mem   box_loss   cls_loss   dfl_loss  Instances       Size
      18/80       9.8G       1.32     0.9374     0.9085        669        640: 100%|██████████| 405/405 [01:33<00:00,  4.34it/s]
                 Class     Images  Instances      Box(P          R      mAP50  mAP50-95): 100%|██████████| 18/18 [00:04<00:00,  4.07it/s]
                   all        548      38759      0.469      0.353      0.359      0.211
  0%|          | 0/405 [00:00<?, ?it/s]
      Epoch    GPU_mem   box_loss   cls_loss   dfl_loss  Instances       Size
      19/80      8.65G      1.311     0.9297     0.9062        818        640: 100%|██████████| 405/405 [01:32<00:00,  4.36it/s]
                 Class     Images  Instances      Box(P          R      mAP50  mAP50-95): 100%|██████████| 18/18 [00:04<00:00,  4.08it/s]
                   all        548      38759      0.467       0.36      0.361      0.211
  0%|          | 0/405 [00:00<?, ?it/s]
      Epoch    GPU_mem   box_loss   cls_loss   dfl_loss  Instances       Size
      20/80      9.05G      1.306     0.9179     0.9047        494        640: 100%|██████████| 405/405 [01:33<00:00,  4.34it/s]
                 Class     Images  Instances      Box(P          R      mAP50  mAP50-95): 100%|██████████| 18/18 [00:04<00:00,  4.04it/s]
                   all        548      38759      0.462      0.354      0.355      0.208

      Epoch    GPU_mem   box_loss   cls_loss   dfl_loss  Instances       Size
      21/80      9.15G      1.298     0.9113     0.9035        307        640: 100%|██████████| 405/405 [01:33<00:00,  4.34it/s]
                 Class     Images  Instances      Box(P          R      mAP50  mAP50-95): 100%|██████████| 18/18 [00:04<00:00,  4.11it/s]
                   all        548      38759      0.477      0.357      0.364      0.214

      Epoch    GPU_mem   box_loss   cls_loss   dfl_loss  Instances       Size
      22/80      8.79G      1.305     0.9122     0.9037        359        640: 100%|██████████| 405/405 [01:33<00:00,  4.35it/s]
                 Class     Images  Instances      Box(P          R      mAP50  mAP50-95): 100%|██████████| 18/18 [00:04<00:00,  4.04it/s]
                   all        548      38759      0.463      0.362      0.364      0.213
  0%|          | 0/405 [00:00<?, ?it/s]
      Epoch    GPU_mem   box_loss   cls_loss   dfl_loss  Instances       Size
      23/80      10.1G      1.302     0.9114     0.9033        595        640: 100%|██████████| 405/405 [01:33<00:00,  4.34it/s]
                 Class     Images  Instances      Box(P          R      mAP50  mAP50-95): 100%|██████████| 18/18 [00:04<00:00,  4.23it/s]
                   all        548      38759       0.47      0.368      0.366      0.214

      Epoch    GPU_mem   box_loss   cls_loss   dfl_loss  Instances       Size
      24/80      10.5G      1.289     0.8991      0.901        793        640: 100%|██████████| 405/405 [01:32<00:00,  4.36it/s]
                 Class     Images  Instances      Box(P          R      mAP50  mAP50-95): 100%|██████████| 18/18 [00:04<00:00,  4.28it/s]
                   all        548      38759      0.467      0.362      0.368      0.219

      Epoch    GPU_mem   box_loss   cls_loss   dfl_loss  Instances       Size
      25/80      9.42G      1.278     0.8848     0.8995        555        640: 100%|██████████| 405/405 [01:33<00:00,  4.35it/s]
                 Class     Images  Instances      Box(P          R      mAP50  mAP50-95): 100%|██████████| 18/18 [00:04<00:00,  4.18it/s]
                   all        548      38759      0.484      0.361       0.37      0.219
  0%|          | 0/405 [00:00<?, ?it/s]
      Epoch    GPU_mem   box_loss   cls_loss   dfl_loss  Instances       Size
      26/80      8.88G      1.285     0.8924     0.9004        510        640: 100%|██████████| 405/405 [01:32<00:00,  4.36it/s]
                 Class     Images  Instances      Box(P          R      mAP50  mAP50-95): 100%|██████████| 18/18 [00:04<00:00,  4.22it/s]
                   all        548      38759      0.493      0.363      0.374      0.219

      Epoch    GPU_mem   box_loss   cls_loss   dfl_loss  Instances       Size
      27/80      7.91G      1.277     0.8849     0.8981        404        640: 100%|██████████| 405/405 [01:32<00:00,  4.36it/s]
                 Class     Images  Instances      Box(P          R      mAP50  mAP50-95): 100%|██████████| 18/18 [00:04<00:00,  4.23it/s]
                   all        548      38759       0.48      0.368      0.375      0.221
  0%|          | 0/405 [00:00<?, ?it/s]
      Epoch    GPU_mem   box_loss   cls_loss   dfl_loss  Instances       Size
      28/80      9.34G      1.273     0.8754     0.8976        877        640: 100%|██████████| 405/405 [01:32<00:00,  4.37it/s]
                 Class     Images  Instances      Box(P          R      mAP50  mAP50-95): 100%|██████████| 18/18 [00:04<00:00,  4.24it/s]
                   all        548      38759      0.478      0.366      0.375      0.221

      Epoch    GPU_mem   box_loss   cls_loss   dfl_loss  Instances       Size
      29/80       7.9G      1.268     0.8718      0.896        456        640: 100%|██████████| 405/405 [01:32<00:00,  4.36it/s]
                 Class     Images  Instances      Box(P          R      mAP50  mAP50-95): 100%|██████████| 18/18 [00:04<00:00,  4.23it/s]
                   all        548      38759      0.491      0.363      0.372      0.217

      Epoch    GPU_mem   box_loss   cls_loss   dfl_loss  Instances       Size
      30/80        10G      1.262     0.8639     0.8954        422        640: 100%|██████████| 405/405 [01:32<00:00,  4.37it/s]
                 Class     Images  Instances      Box(P          R      mAP50  mAP50-95): 100%|██████████| 18/18 [00:04<00:00,  4.30it/s]
                   all        548      38759      0.487      0.371       0.38      0.224

      Epoch    GPU_mem   box_loss   cls_loss   dfl_loss  Instances       Size
      31/80      8.73G      1.263     0.8606     0.8947        543        640: 100%|██████████| 405/405 [01:32<00:00,  4.36it/s]
                 Class     Images  Instances      Box(P          R      mAP50  mAP50-95): 100%|██████████| 18/18 [00:04<00:00,  4.23it/s]
                   all        548      38759      0.479      0.374      0.381      0.224
  0%|          | 0/405 [00:00<?, ?it/s]
      Epoch    GPU_mem   box_loss   cls_loss   dfl_loss  Instances       Size
      32/80      7.97G      1.261     0.8591     0.8944        494        640: 100%|██████████| 405/405 [01:32<00:00,  4.37it/s]
                 Class     Images  Instances      Box(P          R      mAP50  mAP50-95): 100%|██████████| 18/18 [00:04<00:00,  4.28it/s]
                   all        548      38759       0.48      0.362      0.375      0.222

      Epoch    GPU_mem   box_loss   cls_loss   dfl_loss  Instances       Size
      33/80       8.6G      1.257     0.8553     0.8928        393        640: 100%|██████████| 405/405 [01:32<00:00,  4.37it/s]
                 Class     Images  Instances      Box(P          R      mAP50  mAP50-95): 100%|██████████| 18/18 [00:04<00:00,  4.29it/s]
                   all        548      38759      0.485      0.373      0.381      0.225

      Epoch    GPU_mem   box_loss   cls_loss   dfl_loss  Instances       Size
      34/80       7.8G      1.254     0.8479     0.8926        564        640: 100%|██████████| 405/405 [01:32<00:00,  4.36it/s]
                 Class     Images  Instances      Box(P          R      mAP50  mAP50-95): 100%|██████████| 18/18 [00:04<00:00,  4.27it/s]
                   all        548      38759      0.498      0.375      0.385      0.229
  0%|          | 0/405 [00:00<?, ?it/s]
      Epoch    GPU_mem   box_loss   cls_loss   dfl_loss  Instances       Size
      35/80      8.54G      1.248     0.8422     0.8925        498        640: 100%|██████████| 405/405 [01:32<00:00,  4.36it/s]
                 Class     Images  Instances      Box(P          R      mAP50  mAP50-95): 100%|██████████| 18/18 [00:04<00:00,  4.27it/s]
                   all        548      38759      0.492      0.377      0.385      0.229
  0%|          | 0/405 [00:00<?, ?it/s]
      Epoch    GPU_mem   box_loss   cls_loss   dfl_loss  Instances       Size
      36/80      7.48G      1.241     0.8365     0.8903        587        640: 100%|██████████| 405/405 [01:32<00:00,  4.36it/s]
                 Class     Images  Instances      Box(P          R      mAP50  mAP50-95): 100%|██████████| 18/18 [00:04<00:00,  4.25it/s]
                   all        548      38759      0.497      0.372      0.384      0.227

      Epoch    GPU_mem   box_loss   cls_loss   dfl_loss  Instances       Size
      37/80      10.4G      1.243     0.8382       0.89        634        640: 100%|██████████| 405/405 [01:33<00:00,  4.35it/s]
                 Class     Images  Instances      Box(P          R      mAP50  mAP50-95): 100%|██████████| 18/18 [00:04<00:00,  4.28it/s]
                   all        548      38759        0.5      0.381      0.392      0.232
  0%|          | 0/405 [00:00<?, ?it/s]
      Epoch    GPU_mem   box_loss   cls_loss   dfl_loss  Instances       Size
      38/80      9.82G      1.237     0.8309     0.8893        701        640: 100%|██████████| 405/405 [01:32<00:00,  4.36it/s]
                 Class     Images  Instances      Box(P          R      mAP50  mAP50-95): 100%|██████████| 18/18 [00:04<00:00,  4.25it/s]
                   all        548      38759        0.5      0.376      0.385      0.228
  0%|          | 0/405 [00:00<?, ?it/s]
      Epoch    GPU_mem   box_loss   cls_loss   dfl_loss  Instances       Size
      39/80      8.61G      1.245     0.8318     0.8889        604        640: 100%|██████████| 405/405 [01:33<00:00,  4.35it/s]
                 Class     Images  Instances      Box(P          R      mAP50  mAP50-95): 100%|██████████| 18/18 [00:04<00:00,  4.24it/s]
                   all        548      38759      0.498      0.374      0.387      0.229

      Epoch    GPU_mem   box_loss   cls_loss   dfl_loss  Instances       Size
      40/80      9.84G      1.237     0.8267       0.89        691        640: 100%|██████████| 405/405 [01:32<00:00,  4.37it/s]
                 Class     Images  Instances      Box(P          R      mAP50  mAP50-95): 100%|██████████| 18/18 [00:04<00:00,  4.25it/s]
                   all        548      38759      0.498      0.378      0.387      0.229
  0%|          | 0/405 [00:00<?, ?it/s]
      Epoch    GPU_mem   box_loss   cls_loss   dfl_loss  Instances       Size
      41/80      10.9G      1.231     0.8183     0.8874        554        640: 100%|██████████| 405/405 [01:32<00:00,  4.37it/s]
                 Class     Images  Instances      Box(P          R      mAP50  mAP50-95): 100%|██████████| 18/18 [00:04<00:00,  4.25it/s]
                   all        548      38759      0.492      0.384      0.389       0.23
  0%|          | 0/405 [00:00<?, ?it/s]
      Epoch    GPU_mem   box_loss   cls_loss   dfl_loss  Instances       Size
      42/80       9.5G      1.227     0.8149     0.8865        353        640: 100%|██████████| 405/405 [01:32<00:00,  4.36it/s]
                 Class     Images  Instances      Box(P          R      mAP50  mAP50-95): 100%|██████████| 18/18 [00:04<00:00,  4.29it/s]
                   all        548      38759      0.502      0.375      0.388       0.23

      Epoch    GPU_mem   box_loss   cls_loss   dfl_loss  Instances       Size
      43/80      8.84G      1.226     0.8167     0.8859        446        640: 100%|██████████| 405/405 [01:32<00:00,  4.36it/s]
                 Class     Images  Instances      Box(P          R      mAP50  mAP50-95): 100%|██████████| 18/18 [00:04<00:00,  4.28it/s]
                   all        548      38759      0.494      0.379      0.387      0.229
  0%|          | 0/405 [00:00<?, ?it/s]
      Epoch    GPU_mem   box_loss   cls_loss   dfl_loss  Instances       Size
      44/80      8.83G      1.221     0.8077     0.8844        957        640: 100%|██████████| 405/405 [01:32<00:00,  4.38it/s]
                 Class     Images  Instances      Box(P          R      mAP50  mAP50-95): 100%|██████████| 18/18 [00:04<00:00,  4.28it/s]
                   all        548      38759      0.487      0.383      0.391      0.232
  0%|          | 0/405 [00:00<?, ?it/s]
      Epoch    GPU_mem   box_loss   cls_loss   dfl_loss  Instances       Size
      45/80      9.22G      1.218     0.8035     0.8844        568        640: 100%|██████████| 405/405 [01:32<00:00,  4.37it/s]
                 Class     Images  Instances      Box(P          R      mAP50  mAP50-95): 100%|██████████| 18/18 [00:04<00:00,  4.30it/s]
                   all        548      38759      0.485      0.385       0.39      0.232
  0%|          | 0/405 [00:00<?, ?it/s]
      Epoch    GPU_mem   box_loss   cls_loss   dfl_loss  Instances       Size
      46/80      10.1G      1.214     0.7988     0.8837        506        640: 100%|██████████| 405/405 [01:32<00:00,  4.37it/s]
                 Class     Images  Instances      Box(P          R      mAP50  mAP50-95): 100%|██████████| 18/18 [00:04<00:00,  4.29it/s]
                   all        548      38759      0.491      0.384       0.39      0.232
  0%|          | 0/405 [00:00<?, ?it/s]
      Epoch    GPU_mem   box_loss   cls_loss   dfl_loss  Instances       Size
      47/80      13.2G      1.214     0.7962     0.8843        616        640: 100%|██████████| 405/405 [01:39<00:00,  4.07it/s]
                 Class     Images  Instances      Box(P          R      mAP50  mAP50-95): 100%|██████████| 18/18 [00:04<00:00,  4.26it/s]
                   all        548      38759      0.484      0.386      0.388       0.23
  0%|          | 0/405 [00:00<?, ?it/s]
      Epoch    GPU_mem   box_loss   cls_loss   dfl_loss  Instances       Size
      48/80      12.1G      1.214     0.7956     0.8845       1312        640: 100%|██████████| 405/405 [01:36<00:00,  4.19it/s]
                 Class     Images  Instances      Box(P          R      mAP50  mAP50-95): 100%|██████████| 18/18 [00:04<00:00,  4.29it/s]
                   all        548      38759      0.498      0.381      0.391      0.231
  0%|          | 0/405 [00:00<?, ?it/s]
      Epoch    GPU_mem   box_loss   cls_loss   dfl_loss  Instances       Size
      49/80      10.9G       1.21     0.7897     0.8833        588        640: 100%|██████████| 405/405 [01:33<00:00,  4.35it/s]
                 Class     Images  Instances      Box(P          R      mAP50  mAP50-95): 100%|██████████| 18/18 [00:04<00:00,  4.32it/s]
                   all        548      38759      0.495      0.379      0.391      0.232
  0%|          | 0/405 [00:00<?, ?it/s]
      Epoch    GPU_mem   box_loss   cls_loss   dfl_loss  Instances       Size
      50/80      10.7G      1.208     0.7851     0.8831        434        640: 100%|██████████| 405/405 [01:33<00:00,  4.34it/s]
                 Class     Images  Instances      Box(P          R      mAP50  mAP50-95): 100%|██████████| 18/18 [00:04<00:00,  4.32it/s]
                   all        548      38759      0.504       0.38      0.392      0.233

      Epoch    GPU_mem   box_loss   cls_loss   dfl_loss  Instances       Size
      51/80      10.4G      1.209     0.7861     0.8816        673        640: 100%|██████████| 405/405 [01:32<00:00,  4.36it/s]
                 Class     Images  Instances      Box(P          R      mAP50  mAP50-95): 100%|██████████| 18/18 [00:04<00:00,  4.33it/s]
                   all        548      38759      0.498       0.38      0.391      0.231
  0%|          | 0/405 [00:00<?, ?it/s]
      Epoch    GPU_mem   box_loss   cls_loss   dfl_loss  Instances       Size
      52/80      12.2G        1.2     0.7801     0.8825        436        640: 100%|██████████| 405/405 [01:35<00:00,  4.24it/s]
                 Class     Images  Instances      Box(P          R      mAP50  mAP50-95): 100%|██████████| 18/18 [00:04<00:00,  4.31it/s]
                   all        548      38759      0.486      0.387      0.392      0.232

      Epoch    GPU_mem   box_loss   cls_loss   dfl_loss  Instances       Size
      53/80      10.3G      1.202     0.7788     0.8812        593        640: 100%|██████████| 405/405 [01:33<00:00,  4.35it/s]
                 Class     Images  Instances      Box(P          R      mAP50  mAP50-95): 100%|██████████| 18/18 [00:04<00:00,  4.21it/s]
                   all        548      38759      0.512      0.378      0.393      0.233
  0%|          | 0/405 [00:00<?, ?it/s]
      Epoch    GPU_mem   box_loss   cls_loss   dfl_loss  Instances       Size
      54/80      12.1G      1.196     0.7726     0.8799        618        640: 100%|██████████| 405/405 [02:12<00:00,  3.06it/s]
                 Class     Images  Instances      Box(P          R      mAP50  mAP50-95): 100%|██████████| 18/18 [00:08<00:00,  2.08it/s]
                   all        548      38759      0.509      0.382      0.393      0.231
  0%|          | 0/405 [00:00<?, ?it/s]
      Epoch    GPU_mem   box_loss   cls_loss   dfl_loss  Instances       Size
      55/80      7.17G      1.189      0.766     0.8791        846        640: 100%|██████████| 405/405 [01:32<00:00,  4.36it/s]
                 Class     Images  Instances      Box(P          R      mAP50  mAP50-95): 100%|██████████| 18/18 [00:04<00:00,  4.28it/s]
                   all        548      38759      0.497      0.388      0.395      0.234
  0%|          | 0/405 [00:00<?, ?it/s]
      Epoch    GPU_mem   box_loss   cls_loss   dfl_loss  Instances       Size
      56/80      8.14G      1.191     0.7663     0.8789        822        640: 100%|██████████| 405/405 [01:32<00:00,  4.36it/s]
                 Class     Images  Instances      Box(P          R      mAP50  mAP50-95): 100%|██████████| 18/18 [00:04<00:00,  4.29it/s]
                   all        548      38759      0.504      0.382      0.392      0.233

      Epoch    GPU_mem   box_loss   cls_loss   dfl_loss  Instances       Size
      57/80       8.6G      1.194     0.7641     0.8793        709        640: 100%|██████████| 405/405 [01:33<00:00,  4.33it/s]
                 Class     Images  Instances      Box(P          R      mAP50  mAP50-95): 100%|██████████| 18/18 [00:04<00:00,  4.25it/s]
                   all        548      38759      0.504      0.385      0.393      0.233

      Epoch    GPU_mem   box_loss   cls_loss   dfl_loss  Instances       Size
      58/80      7.88G      1.185     0.7569     0.8778        442        640: 100%|██████████| 405/405 [01:32<00:00,  4.36it/s]
                 Class     Images  Instances      Box(P          R      mAP50  mAP50-95): 100%|██████████| 18/18 [00:04<00:00,  4.25it/s]
                   all        548      38759      0.501      0.387      0.393      0.233
  0%|          | 0/405 [00:00<?, ?it/s]
      Epoch    GPU_mem   box_loss   cls_loss   dfl_loss  Instances       Size
      59/80      9.32G      1.183     0.7544     0.8774        438        640: 100%|██████████| 405/405 [01:32<00:00,  4.36it/s]
                 Class     Images  Instances      Box(P          R      mAP50  mAP50-95): 100%|██████████| 18/18 [00:04<00:00,  4.28it/s]
                   all        548      38759      0.502      0.386      0.393      0.234

      Epoch    GPU_mem   box_loss   cls_loss   dfl_loss  Instances       Size
      60/80      9.24G       1.18      0.751     0.8758        747        640: 100%|██████████| 405/405 [01:33<00:00,  4.34it/s]
                 Class     Images  Instances      Box(P          R      mAP50  mAP50-95): 100%|██████████| 18/18 [00:04<00:00,  4.26it/s]
                   all        548      38759      0.508       0.39      0.396      0.236
  0%|          | 0/405 [00:00<?, ?it/s]
      Epoch    GPU_mem   box_loss   cls_loss   dfl_loss  Instances       Size
      61/80      12.1G      1.178     0.7461     0.8762        627        640: 100%|██████████| 405/405 [01:35<00:00,  4.26it/s]
                 Class     Images  Instances      Box(P          R      mAP50  mAP50-95): 100%|██████████| 18/18 [00:04<00:00,  4.30it/s]
                   all        548      38759      0.511      0.383      0.396      0.235
  0%|          | 0/405 [00:00<?, ?it/s]
      Epoch    GPU_mem   box_loss   cls_loss   dfl_loss  Instances       Size
      62/80      12.2G      1.178     0.7471     0.8773        521        640: 100%|██████████| 405/405 [01:35<00:00,  4.26it/s]
                 Class     Images  Instances      Box(P          R      mAP50  mAP50-95): 100%|██████████| 18/18 [00:04<00:00,  4.30it/s]
                   all        548      38759        0.5      0.388      0.394      0.234
  0%|          | 0/405 [00:00<?, ?it/s]
      Epoch    GPU_mem   box_loss   cls_loss   dfl_loss  Instances       Size
      63/80      9.46G      1.173     0.7435     0.8744        427        640: 100%|██████████| 405/405 [01:33<00:00,  4.34it/s]
                 Class     Images  Instances      Box(P          R      mAP50  mAP50-95): 100%|██████████| 18/18 [00:04<00:00,  4.31it/s]
                   all        548      38759      0.503      0.385      0.394      0.233
  0%|          | 0/405 [00:00<?, ?it/s]
      Epoch    GPU_mem   box_loss   cls_loss   dfl_loss  Instances       Size
      64/80      8.46G      1.173     0.7368     0.8756        389        640: 100%|██████████| 405/405 [01:32<00:00,  4.36it/s]
                 Class     Images  Instances      Box(P          R      mAP50  mAP50-95): 100%|██████████| 18/18 [00:04<00:00,  4.29it/s]
                   all        548      38759      0.511      0.385      0.395      0.233

      Epoch    GPU_mem   box_loss   cls_loss   dfl_loss  Instances       Size
      65/80      6.55G      1.169     0.7365     0.8748        550        640: 100%|██████████| 405/405 [01:32<00:00,  4.36it/s]
                 Class     Images  Instances      Box(P          R      mAP50  mAP50-95): 100%|██████████| 18/18 [00:04<00:00,  4.33it/s]
                   all        548      38759      0.494      0.389      0.393      0.233
  0%|          | 0/405 [00:00<?, ?it/s]
      Epoch    GPU_mem   box_loss   cls_loss   dfl_loss  Instances       Size
      66/80      8.44G      1.172     0.7366     0.8746        704        640: 100%|██████████| 405/405 [01:33<00:00,  4.35it/s]
                 Class     Images  Instances      Box(P          R      mAP50  mAP50-95): 100%|██████████| 18/18 [00:04<00:00,  4.29it/s]
                   all        548      38759      0.504      0.379      0.394      0.233
  0%|          | 0/405 [00:00<?, ?it/s]
      Epoch    GPU_mem   box_loss   cls_loss   dfl_loss  Instances       Size
      67/80      7.33G      1.164       0.73     0.8738        413        640: 100%|██████████| 405/405 [01:32<00:00,  4.36it/s]
                 Class     Images  Instances      Box(P          R      mAP50  mAP50-95): 100%|██████████| 18/18 [00:04<00:00,  4.26it/s]
                   all        548      38759      0.499       0.38      0.393      0.232

      Epoch    GPU_mem   box_loss   cls_loss   dfl_loss  Instances       Size
      68/80      9.56G      1.166     0.7258     0.8733        499        640: 100%|██████████| 405/405 [01:33<00:00,  4.33it/s]
                 Class     Images  Instances      Box(P          R      mAP50  mAP50-95): 100%|██████████| 18/18 [00:04<00:00,  4.28it/s]
                   all        548      38759      0.493      0.385      0.394      0.232
  0%|          | 0/405 [00:00<?, ?it/s]
      Epoch    GPU_mem   box_loss   cls_loss   dfl_loss  Instances       Size
      69/80      9.95G      1.162     0.7246     0.8724        691        640: 100%|██████████| 405/405 [01:33<00:00,  4.33it/s]
                 Class     Images  Instances      Box(P          R      mAP50  mAP50-95): 100%|██████████| 18/18 [00:04<00:00,  4.32it/s]
                   all        548      38759      0.506      0.385      0.396      0.234
  0%|          | 0/405 [00:00<?, ?it/s]
      Epoch    GPU_mem   box_loss   cls_loss   dfl_loss  Instances       Size
      70/80      7.84G      1.152     0.7175     0.8715        596        640: 100%|██████████| 405/405 [01:32<00:00,  4.37it/s]
                 Class     Images  Instances      Box(P          R      mAP50  mAP50-95): 100%|██████████| 18/18 [00:04<00:00,  4.32it/s]
                   all        548      38759        0.5      0.383      0.395      0.235
Closing dataloader mosaic
  0%|          | 0/405 [00:00<?, ?it/s]
      Epoch    GPU_mem   box_loss   cls_loss   dfl_loss  Instances       Size
      71/80      10.1G      1.139     0.7015     0.8726        439        640: 100%|██████████| 405/405 [01:28<00:00,  4.59it/s]
                 Class     Images  Instances      Box(P          R      mAP50  mAP50-95): 100%|██████████| 18/18 [00:04<00:00,  4.31it/s]
                   all        548      38759      0.504      0.376      0.392      0.233

      Epoch    GPU_mem   box_loss   cls_loss   dfl_loss  Instances       Size
      72/80      9.21G      1.134     0.6939     0.8703        345        640: 100%|██████████| 405/405 [01:27<00:00,  4.61it/s]
                 Class     Images  Instances      Box(P          R      mAP50  mAP50-95): 100%|██████████| 18/18 [00:04<00:00,  4.32it/s]
                   all        548      38759      0.508      0.378      0.392      0.232

      Epoch    GPU_mem   box_loss   cls_loss   dfl_loss  Instances       Size
      73/80      11.9G      1.126     0.6842     0.8695        252        640: 100%|██████████| 405/405 [01:29<00:00,  4.54it/s]
                 Class     Images  Instances      Box(P          R      mAP50  mAP50-95): 100%|██████████| 18/18 [00:04<00:00,  4.30it/s]
                   all        548      38759      0.499      0.383      0.392      0.232
  0%|          | 0/405 [00:00<?, ?it/s]
      Epoch    GPU_mem   box_loss   cls_loss   dfl_loss  Instances       Size
      74/80      10.6G      1.123     0.6812     0.8702        187        640: 100%|██████████| 405/405 [01:27<00:00,  4.61it/s]
                 Class     Images  Instances      Box(P          R      mAP50  mAP50-95): 100%|██████████| 18/18 [00:04<00:00,  4.26it/s]
                   all        548      38759      0.506      0.378      0.392      0.232
  0%|          | 0/405 [00:00<?, ?it/s]
      Epoch    GPU_mem   box_loss   cls_loss   dfl_loss  Instances       Size
      75/80      9.38G      1.117     0.6748     0.8673        308        640: 100%|██████████| 405/405 [01:27<00:00,  4.63it/s]
                 Class     Images  Instances      Box(P          R      mAP50  mAP50-95): 100%|██████████| 18/18 [00:04<00:00,  4.27it/s]
                   all        548      38759      0.502       0.38      0.393      0.232
  0%|          | 0/405 [00:00<?, ?it/s]
      Epoch    GPU_mem   box_loss   cls_loss   dfl_loss  Instances       Size
      76/80        10G      1.118     0.6742     0.8675        467        640: 100%|██████████| 405/405 [01:27<00:00,  4.61it/s]
                 Class     Images  Instances      Box(P          R      mAP50  mAP50-95): 100%|██████████| 18/18 [00:04<00:00,  4.31it/s]
                   all        548      38759      0.504      0.378      0.393      0.232

      Epoch    GPU_mem   box_loss   cls_loss   dfl_loss  Instances       Size
      77/80      8.48G      1.113     0.6707     0.8676        491        640: 100%|██████████| 405/405 [01:27<00:00,  4.62it/s]
                 Class     Images  Instances      Box(P          R      mAP50  mAP50-95): 100%|██████████| 18/18 [00:04<00:00,  4.29it/s]
                   all        548      38759      0.502      0.379      0.392      0.232

      Epoch    GPU_mem   box_loss   cls_loss   dfl_loss  Instances       Size
      78/80      9.26G      1.113     0.6702     0.8669        374        640: 100%|██████████| 405/405 [01:27<00:00,  4.62it/s]
                 Class     Images  Instances      Box(P          R      mAP50  mAP50-95): 100%|██████████| 18/18 [00:04<00:00,  4.30it/s]
                   all        548      38759      0.499      0.381      0.393      0.232

      Epoch    GPU_mem   box_loss   cls_loss   dfl_loss  Instances       Size
      79/80      8.02G      1.111     0.6649     0.8661        571        640: 100%|██████████| 405/405 [01:27<00:00,  4.62it/s]
                 Class     Images  Instances      Box(P          R      mAP50  mAP50-95): 100%|██████████| 18/18 [00:04<00:00,  4.26it/s]
                   all        548      38759      0.504      0.379      0.393      0.232
  0%|          | 0/405 [00:00<?, ?it/s]
      Epoch    GPU_mem   box_loss   cls_loss   dfl_loss  Instances       Size
      80/80      8.29G      1.113      0.667     0.8653        324        640: 100%|██████████| 405/405 [01:27<00:00,  4.61it/s]
                 Class     Images  Instances      Box(P          R      mAP50  mAP50-95): 100%|██████████| 18/18 [00:04<00:00,  4.29it/s]
                   all        548      38759      0.505      0.379      0.393      0.232
EarlyStopping: Training stopped early as no improvement observed in last 20 epochs. Best results observed at epoch 60, best model saved as best.pt.
To update EarlyStopping(patience=20) pass a new patience value, i.e. `patience=300` or use `patience=0` to disable EarlyStopping.

80 epochs completed in 9.560 hours.
Optimizer stripped from D:\Project\VisDrone_Experiment\runs\baseline\weights\last.pt, 22.5MB
Optimizer stripped from D:\Project\VisDrone_Experiment\runs\baseline\weights\best.pt, 22.5MB

Validating D:\Project\VisDrone_Experiment\runs\baseline\weights\best.pt...
Ultralytics 8.3.146  Python-3.9.13 torch-2.2.2+cu118 CUDA:0 (NVIDIA GeForce RTX 3060, 12288MiB)
Model summary (fused): 72 layers, 11,129,454 parameters, 0 gradients, 28.5 GFLOPs
                 Class     Images  Instances      Box(P          R      mAP50  mAP50-95): 100%|██████████| 18/18 [00:13<00:00,  1.33it/s]
                   all        548      38759      0.507       0.39      0.396      0.236
Speed: 0.1ms preprocess, 2.3ms inference, 0.0ms loss, 2.3ms postprocess per image
Results saved to D:\Project\VisDrone_Experiment\runs\baseline
✅ 训练完成
开始评估...
Ultralytics 8.3.146  Python-3.9.13 torch-2.2.2+cu118 CUDA:0 (NVIDIA GeForce RTX 3060, 12288MiB)
Model summary (fused): 72 layers, 11,129,454 parameters, 0 gradients, 28.5 GFLOPs
val: Fast image access  (ping: 0.10.0 ms, read: 1388.8333.6 MB/s, size: 153.1 KB)
val: Scanning D:\Project\VisDrone_Experiment\VisDrone2019-DET\labels\val.cache... 548 images, 0 backgrounds, 0 corrupt: 100%|██████████| 548/548 [00:00<?, ?it/s]
                 Class     Images  Instances      Box(P          R      mAP50  mAP50-95): 100%|██████████| 35/35 [00:15<00:00,  2.21it/s]
                   all        548      38759      0.517      0.395      0.402      0.237
Speed: 0.3ms preprocess, 5.6ms inference, 0.0ms loss, 4.7ms postprocess per image
Results saved to D:\VoiceRecognition\VoiceprintRecognition-Pytorch\runs\detect\val
❌ 评估失败: 'Metric' object has no attribute 'precision'. See valid attributes below.

    Class for computing evaluation metrics for Ultralytics YOLO models.

    Attributes:
        p (list): Precision for each class. Shape: (nc,).
        r (list): Recall for each class. Shape: (nc,).
        f1 (list): F1 score for each class. Shape: (nc,).
        all_ap (list): AP scores for all classes and all IoU thresholds. Shape: (nc, 10).
        ap_class_index (list): Index of class for each AP score. Shape: (nc,).
        nc (int): Number of classes.

    Methods:
        ap50(): AP at IoU threshold of 0.5 for all classes. Returns: List of AP scores. Shape: (nc,) or [].
        ap(): AP at IoU thresholds from 0.5 to 0.95 for all classes. Returns: List of AP scores. Shape: (nc,) or [].
        mp(): Mean precision of all classes. Returns: Float.
        mr(): Mean recall of all classes. Returns: Float.
        map50(): Mean AP at IoU threshold of 0.5 for all classes. Returns: Float.
        map75(): Mean AP at IoU threshold of 0.75 for all classes. Returns: Float.
        map(): Mean AP at IoU thresholds from 0.5 to 0.95 for all classes. Returns: Float.
        mean_results(): Mean of results, returns mp, mr, map50, map.
        class_result(i): Class-aware result, returns p[i], r[i], ap50[i], ap[i].
        maps(): mAP of each class. Returns: Array of mAP scores, shape: (nc,).
        fitness(): Model fitness as a weighted combination of metrics. Returns: Float.
        update(results): Update metric attributes with new evaluation results.


🎯 实验 ema: YOLOv8s + EMA注意力
--------------------------------------------------
开始训练...
🔧 集成EMA注意力机制...
✅ 在 model.4 添加EMA注意力 (通道数: 128)
✅ 在 model.6 添加EMA注意力 (通道数: 256)
✅ 在 model.9 添加EMA注意力 (通道数: 512)
Ultralytics 8.3.146  Python-3.9.13 torch-2.2.2+cu118 CUDA:0 (NVIDIA GeForce RTX 3060, 12288MiB)
engine\trainer: agnostic_nms=False, amp=True, augment=False, auto_augment=randaugment, batch=16, bgr=0.0, box=7.5, cache=False, cfg=None, classes=None, close_mosaic=10, cls=0.5, conf=None, copy_paste=0.0, copy_paste_mode=flip, cos_lr=False, cutmix=0.0, data=D:\Project\VisDrone_Experiment\configs\dataset\visdrone.yaml, degrees=0.0, deterministic=True, device=0, dfl=1.5, dnn=False, dropout=0.0, dynamic=False, embed=None, epochs=80, erasing=0.4, exist_ok=True, fliplr=0.5, flipud=0.0, format=torchscript, fraction=1.0, freeze=None, half=False, hsv_h=0.015, hsv_s=0.7, hsv_v=0.4, imgsz=640, int8=False, iou=0.7, keras=False, kobj=1.0, line_width=None, lr0=0.01, lrf=0.01, mask_ratio=4, max_det=300, mixup=0.0, mode=train, model=yolov8s.pt, momentum=0.937, mosaic=1.0, multi_scale=False, name=ema, nbs=64, nms=False, opset=None, optimize=False, optimizer=auto, overlap_mask=True, patience=20, perspective=0.0, plots=True, pose=12.0, pretrained=True, profile=False, project=D:\Project\VisDrone_Experiment\runs, rect=False, resume=False, retina_masks=False, save=True, save_conf=False, save_crop=False, save_dir=D:\Project\VisDrone_Experiment\runs\ema, save_frames=False, save_json=False, save_period=-1, save_txt=False, scale=0.5, seed=0, shear=0.0, show=False, show_boxes=True, show_conf=True, show_labels=True, simplify=True, single_cls=False, source=None, split=val, stream_buffer=False, task=detect, time=None, tracker=botsort.yaml, translate=0.1, val=True, verbose=False, vid_stride=1, visualize=False, warmup_bias_lr=0.1, warmup_epochs=3.0, warmup_momentum=0.8, weight_decay=0.0005, workers=4, workspace=None
Overriding model.yaml nc=80 with nc=10

                   from  n    params  module                                       arguments
  0                  -1  1       928  ultralytics.nn.modules.conv.Conv             [3, 32, 3, 2]
  1                  -1  1     18560  ultralytics.nn.modules.conv.Conv             [32, 64, 3, 2]
  2                  -1  1     29056  ultralytics.nn.modules.block.C2f             [64, 64, 1, True]
  3                  -1  1     73984  ultralytics.nn.modules.conv.Conv             [64, 128, 3, 2]
  4                  -1  2    197632  ultralytics.nn.modules.block.C2f             [128, 128, 2, True]
  5                  -1  1    295424  ultralytics.nn.modules.conv.Conv             [128, 256, 3, 2]
  6                  -1  2    788480  ultralytics.nn.modules.block.C2f             [256, 256, 2, True]
  7                  -1  1   1180672  ultralytics.nn.modules.conv.Conv             [256, 512, 3, 2]
  8                  -1  1   1838080  ultralytics.nn.modules.block.C2f             [512, 512, 1, True]
  9                  -1  1    656896  ultralytics.nn.modules.block.SPPF            [512, 512, 5]
 10                  -1  1         0  torch.nn.modules.upsampling.Upsample         [None, 2, 'nearest']
 11             [-1, 6]  1         0  ultralytics.nn.modules.conv.Concat           [1]
 12                  -1  1    591360  ultralytics.nn.modules.block.C2f             [768, 256, 1]
 13                  -1  1         0  torch.nn.modules.upsampling.Upsample         [None, 2, 'nearest']
 14             [-1, 4]  1         0  ultralytics.nn.modules.conv.Concat           [1]
 15                  -1  1    148224  ultralytics.nn.modules.block.C2f             [384, 128, 1]
 16                  -1  1    147712  ultralytics.nn.modules.conv.Conv             [128, 128, 3, 2]
 17            [-1, 12]  1         0  ultralytics.nn.modules.conv.Concat           [1]
 18                  -1  1    493056  ultralytics.nn.modules.block.C2f             [384, 256, 1]
 19                  -1  1    590336  ultralytics.nn.modules.conv.Conv             [256, 256, 3, 2]
 20             [-1, 9]  1         0  ultralytics.nn.modules.conv.Concat           [1]
 21                  -1  1   1969152  ultralytics.nn.modules.block.C2f             [768, 512, 1]
 22        [15, 18, 21]  1   2119918  ultralytics.nn.modules.head.Detect           [10, [128, 256, 512]]
Model summary: 129 layers, 11,139,470 parameters, 11,139,454 gradients, 28.7 GFLOPs

Transferred 349/355 items from pretrained weights
Freezing layer 'model.22.dfl.conv.weight'
AMP: running Automatic Mixed Precision (AMP) checks...
AMP: checks passed
train: Fast image access  (ping: 0.10.0 ms, read: 1972.7841.2 MB/s, size: 261.9 KB)
train: Scanning D:\Project\VisDrone_Experiment\VisDrone2019-DET\labels\train.cache... 6471 images, 0 backgrounds, 0 corrupt: 100%|██████████| 6471/6471 [00:00<?, ?it/s]
train: D:\Project\VisDrone_Experiment\VisDrone2019-DET\images\train\0000137_02220_d_0000163.jpg: 1 duplicate labels removed
train: D:\Project\VisDrone_Experiment\VisDrone2019-DET\images\train\0000140_00118_d_0000002.jpg: 1 duplicate labels removed
train: D:\Project\VisDrone_Experiment\VisDrone2019-DET\images\train\9999945_00000_d_0000114.jpg: 1 duplicate labels removed
train: D:\Project\VisDrone_Experiment\VisDrone2019-DET\images\train\9999987_00000_d_0000049.jpg: 1 duplicate labels removed
val: Fast image access  (ping: 0.10.0 ms, read: 1143.4188.1 MB/s, size: 131.6 KB)
val: Scanning D:\Project\VisDrone_Experiment\VisDrone2019-DET\labels\val.cache... 548 images, 0 backgrounds, 0 corrupt: 100%|██████████| 548/548 [00:00<?, ?it/s]
Plotting labels to D:\Project\VisDrone_Experiment\runs\ema\labels.jpg...
optimizer: 'optimizer=auto' found, ignoring 'lr0=0.01' and 'momentum=0.937' and determining best 'optimizer', 'lr0' and 'momentum' automatically...
optimizer: AdamW(lr=0.000714, momentum=0.9) with parameter groups 57 weight(decay=0.0), 64 weight(decay=0.0005), 63 bias(decay=0.0)
Image sizes 640 train, 640 val
Using 4 dataloader workers
Logging results to D:\Project\VisDrone_Experiment\runs\ema
Starting training for 80 epochs...

      Epoch    GPU_mem   box_loss   cls_loss   dfl_loss  Instances       Size
       1/80      10.8G      1.567      1.713     0.9978        674        640: 100%|██████████| 405/405 [01:36<00:00,  4.21it/s]
                 Class     Images  Instances      Box(P          R      mAP50  mAP50-95): 100%|██████████| 18/18 [00:04<00:00,  4.08it/s]
                   all        548      38759      0.316      0.256      0.235      0.134
  0%|          | 0/405 [00:00<?, ?it/s]
      Epoch    GPU_mem   box_loss   cls_loss   dfl_loss  Instances       Size
       2/80        10G      1.482      1.201     0.9536        872        640: 100%|██████████| 405/405 [01:33<00:00,  4.32it/s]
                 Class     Images  Instances      Box(P          R      mAP50  mAP50-95): 100%|██████████| 18/18 [00:04<00:00,  4.12it/s]
                   all        548      38759      0.352       0.26      0.243      0.139
  0%|          | 0/405 [00:00<?, ?it/s]
      Epoch    GPU_mem   box_loss   cls_loss   dfl_loss  Instances       Size
       3/80      11.7G      1.463      1.163     0.9503        409        640: 100%|██████████| 405/405 [01:34<00:00,  4.30it/s]
                 Class     Images  Instances      Box(P          R      mAP50  mAP50-95): 100%|██████████| 18/18 [00:04<00:00,  4.16it/s]
                   all        548      38759      0.371      0.293      0.271      0.156

      Epoch    GPU_mem   box_loss   cls_loss   dfl_loss  Instances       Size
       4/80      9.39G      1.448       1.13     0.9425        610        640: 100%|██████████| 405/405 [01:32<00:00,  4.36it/s]
                 Class     Images  Instances      Box(P          R      mAP50  mAP50-95): 100%|██████████| 18/18 [00:04<00:00,  4.14it/s]
                   all        548      38759      0.388      0.301      0.283      0.164
  0%|          | 0/405 [00:00<?, ?it/s]
      Epoch    GPU_mem   box_loss   cls_loss   dfl_loss  Instances       Size
       5/80      8.55G      1.426      1.091     0.9377        591        640: 100%|██████████| 405/405 [01:32<00:00,  4.37it/s]
                 Class     Images  Instances      Box(P          R      mAP50  mAP50-95): 100%|██████████| 18/18 [00:04<00:00,  4.22it/s]
                   all        548      38759      0.413      0.306        0.3      0.172
  0%|          | 0/405 [00:00<?, ?it/s]
      Epoch    GPU_mem   box_loss   cls_loss   dfl_loss  Instances       Size
       6/80      9.26G      1.414      1.072     0.9339        466        640: 100%|██████████| 405/405 [01:33<00:00,  4.34it/s]
                 Class     Images  Instances      Box(P          R      mAP50  mAP50-95): 100%|██████████| 18/18 [00:04<00:00,  4.18it/s]
                   all        548      38759      0.403      0.311        0.3      0.174
  0%|          | 0/405 [00:00<?, ?it/s]
      Epoch    GPU_mem   box_loss   cls_loss   dfl_loss  Instances       Size
       7/80      8.48G      1.398       1.05      0.931        274        640: 100%|██████████| 405/405 [01:32<00:00,  4.37it/s]
                 Class     Images  Instances      Box(P          R      mAP50  mAP50-95): 100%|██████████| 18/18 [00:04<00:00,  4.23it/s]
                   all        548      38759      0.414      0.316      0.309      0.178
  0%|          | 0/405 [00:00<?, ?it/s]
      Epoch    GPU_mem   box_loss   cls_loss   dfl_loss  Instances       Size
       8/80      7.63G      1.382      1.032     0.9253        335        640: 100%|██████████| 405/405 [01:32<00:00,  4.37it/s]
                 Class     Images  Instances      Box(P          R      mAP50  mAP50-95): 100%|██████████| 18/18 [00:04<00:00,  4.24it/s]
                   all        548      38759       0.41      0.335      0.322      0.186

      Epoch    GPU_mem   box_loss   cls_loss   dfl_loss  Instances       Size
       9/80      10.4G      1.378      1.022     0.9241        646        640: 100%|██████████| 405/405 [01:33<00:00,  4.34it/s]
                 Class     Images  Instances      Box(P          R      mAP50  mAP50-95): 100%|██████████| 18/18 [00:04<00:00,  4.18it/s]
                   all        548      38759      0.448      0.322      0.326      0.189
  0%|          | 0/405 [00:00<?, ?it/s]
      Epoch    GPU_mem   box_loss   cls_loss   dfl_loss  Instances       Size
      10/80      10.7G      1.359      1.003     0.9209        634        640: 100%|██████████| 405/405 [01:33<00:00,  4.34it/s]
                 Class     Images  Instances      Box(P          R      mAP50  mAP50-95): 100%|██████████| 18/18 [00:04<00:00,  4.26it/s]
                   all        548      38759      0.429      0.329      0.327      0.189

      Epoch    GPU_mem   box_loss   cls_loss   dfl_loss  Instances       Size
      11/80      9.69G      1.357     0.9957     0.9194        505        640: 100%|██████████| 405/405 [01:33<00:00,  4.35it/s]
                 Class     Images  Instances      Box(P          R      mAP50  mAP50-95): 100%|██████████| 18/18 [00:04<00:00,  4.20it/s]
                   all        548      38759      0.452      0.318      0.325      0.189
  0%|          | 0/405 [00:00<?, ?it/s]
      Epoch    GPU_mem   box_loss   cls_loss   dfl_loss  Instances       Size
      12/80      5.87G      1.344     0.9814     0.9169        629        640: 100%|██████████| 405/405 [01:32<00:00,  4.38it/s]
                 Class     Images  Instances      Box(P          R      mAP50  mAP50-95): 100%|██████████| 18/18 [00:04<00:00,  4.30it/s]
                   all        548      38759      0.461      0.326      0.334      0.194

      Epoch    GPU_mem   box_loss   cls_loss   dfl_loss  Instances       Size
      13/80      8.03G      1.347     0.9754     0.9182        706        640: 100%|██████████| 405/405 [01:33<00:00,  4.34it/s]
                 Class     Images  Instances      Box(P          R      mAP50  mAP50-95): 100%|██████████| 18/18 [00:04<00:00,  4.23it/s]
                   all        548      38759      0.445      0.343      0.341      0.199
  0%|          | 0/405 [00:00<?, ?it/s]
      Epoch    GPU_mem   box_loss   cls_loss   dfl_loss  Instances       Size
      14/80      9.42G      1.336     0.9604     0.9135        475        640: 100%|██████████| 405/405 [01:33<00:00,  4.34it/s]
                 Class     Images  Instances      Box(P          R      mAP50  mAP50-95): 100%|██████████| 18/18 [00:04<00:00,  4.28it/s]
                   all        548      38759      0.452      0.349       0.35      0.205
  0%|          | 0/405 [00:00<?, ?it/s]
      Epoch    GPU_mem   box_loss   cls_loss   dfl_loss  Instances       Size
      15/80      12.3G       1.34     0.9597      0.913        648        640: 100%|██████████| 405/405 [01:36<00:00,  4.22it/s]
                 Class     Images  Instances      Box(P          R      mAP50  mAP50-95): 100%|██████████| 18/18 [00:04<00:00,  4.24it/s]
                   all        548      38759       0.46      0.346      0.352      0.204

      Epoch    GPU_mem   box_loss   cls_loss   dfl_loss  Instances       Size
      16/80      5.98G      1.329     0.9508       0.91        774        640: 100%|██████████| 405/405 [01:33<00:00,  4.35it/s]
                 Class     Images  Instances      Box(P          R      mAP50  mAP50-95): 100%|██████████| 18/18 [00:04<00:00,  4.22it/s]
                   all        548      38759      0.464      0.341      0.347        0.2

      Epoch    GPU_mem   box_loss   cls_loss   dfl_loss  Instances       Size
      17/80      6.96G      1.319     0.9416     0.9092        353        640: 100%|██████████| 405/405 [01:32<00:00,  4.37it/s]
                 Class     Images  Instances      Box(P          R      mAP50  mAP50-95): 100%|██████████| 18/18 [00:04<00:00,  4.17it/s]
                   all        548      38759      0.468      0.343      0.351      0.205
  0%|          | 0/405 [00:00<?, ?it/s]
      Epoch    GPU_mem   box_loss   cls_loss   dfl_loss  Instances       Size
      18/80       9.8G       1.32     0.9374     0.9085        669        640: 100%|██████████| 405/405 [01:33<00:00,  4.35it/s]
                 Class     Images  Instances      Box(P          R      mAP50  mAP50-95): 100%|██████████| 18/18 [00:04<00:00,  4.23it/s]
                   all        548      38759      0.469      0.353      0.359      0.211
  0%|          | 0/405 [00:00<?, ?it/s]
      Epoch    GPU_mem   box_loss   cls_loss   dfl_loss  Instances       Size
      19/80      8.63G      1.311     0.9297     0.9062        818        640: 100%|██████████| 405/405 [01:32<00:00,  4.36it/s]
                 Class     Images  Instances      Box(P          R      mAP50  mAP50-95): 100%|██████████| 18/18 [00:04<00:00,  4.25it/s]
                   all        548      38759      0.467       0.36      0.361      0.211

      Epoch    GPU_mem   box_loss   cls_loss   dfl_loss  Instances       Size
      20/80      9.04G      1.306     0.9179     0.9047        494        640: 100%|██████████| 405/405 [01:33<00:00,  4.34it/s]
                 Class     Images  Instances      Box(P          R      mAP50  mAP50-95): 100%|██████████| 18/18 [00:04<00:00,  4.21it/s]
                   all        548      38759      0.462      0.354      0.355      0.208
  0%|          | 0/405 [00:00<?, ?it/s]
      Epoch    GPU_mem   box_loss   cls_loss   dfl_loss  Instances       Size
      21/80      9.15G      1.298     0.9113     0.9035        307        640: 100%|██████████| 405/405 [01:33<00:00,  4.35it/s]
                 Class     Images  Instances      Box(P          R      mAP50  mAP50-95): 100%|██████████| 18/18 [00:04<00:00,  4.21it/s]
                   all        548      38759      0.477      0.357      0.364      0.214

      Epoch    GPU_mem   box_loss   cls_loss   dfl_loss  Instances       Size
      22/80      8.81G      1.305     0.9122     0.9037        359        640: 100%|██████████| 405/405 [01:33<00:00,  4.35it/s]
                 Class     Images  Instances      Box(P          R      mAP50  mAP50-95): 100%|██████████| 18/18 [00:04<00:00,  4.18it/s]
                   all        548      38759      0.463      0.362      0.364      0.213
  0%|          | 0/405 [00:00<?, ?it/s]
      Epoch    GPU_mem   box_loss   cls_loss   dfl_loss  Instances       Size
      23/80      10.2G      1.302     0.9114     0.9033        595        640: 100%|██████████| 405/405 [01:33<00:00,  4.35it/s]
                 Class     Images  Instances      Box(P          R      mAP50  mAP50-95): 100%|██████████| 18/18 [00:04<00:00,  4.19it/s]
                   all        548      38759       0.47      0.368      0.366      0.214

      Epoch    GPU_mem   box_loss   cls_loss   dfl_loss  Instances       Size
      24/80      10.5G      1.289     0.8991      0.901        793        640: 100%|██████████| 405/405 [01:33<00:00,  4.35it/s]
                 Class     Images  Instances      Box(P          R      mAP50  mAP50-95): 100%|██████████| 18/18 [00:04<00:00,  4.24it/s]
                   all        548      38759      0.467      0.362      0.368      0.219
  0%|          | 0/405 [00:00<?, ?it/s]
      Epoch    GPU_mem   box_loss   cls_loss   dfl_loss  Instances       Size
      25/80      9.41G      1.278     0.8848     0.8995        555        640: 100%|██████████| 405/405 [01:33<00:00,  4.35it/s]
                 Class     Images  Instances      Box(P          R      mAP50  mAP50-95): 100%|██████████| 18/18 [00:04<00:00,  4.22it/s]
                   all        548      38759      0.484      0.361       0.37      0.219

      Epoch    GPU_mem   box_loss   cls_loss   dfl_loss  Instances       Size
      26/80      8.87G      1.285     0.8924     0.9004        510        640: 100%|██████████| 405/405 [01:33<00:00,  4.35it/s]
                 Class     Images  Instances      Box(P          R      mAP50  mAP50-95): 100%|██████████| 18/18 [00:04<00:00,  4.25it/s]
                   all        548      38759      0.493      0.363      0.374      0.219

      Epoch    GPU_mem   box_loss   cls_loss   dfl_loss  Instances       Size
      27/80       7.9G      1.277     0.8849     0.8981        404        640: 100%|██████████| 405/405 [01:33<00:00,  4.35it/s]
                 Class     Images  Instances      Box(P          R      mAP50  mAP50-95): 100%|██████████| 18/18 [00:04<00:00,  4.26it/s]
                   all        548      38759       0.48      0.368      0.375      0.221

      Epoch    GPU_mem   box_loss   cls_loss   dfl_loss  Instances       Size
      28/80      9.35G      1.273     0.8754     0.8976        877        640: 100%|██████████| 405/405 [01:33<00:00,  4.35it/s]
                 Class     Images  Instances      Box(P          R      mAP50  mAP50-95): 100%|██████████| 18/18 [00:04<00:00,  4.27it/s]
                   all        548      38759      0.478      0.366      0.375      0.221

      Epoch    GPU_mem   box_loss   cls_loss   dfl_loss  Instances       Size
      29/80      7.89G      1.268     0.8718      0.896        456        640: 100%|██████████| 405/405 [01:33<00:00,  4.34it/s]
                 Class     Images  Instances      Box(P          R      mAP50  mAP50-95): 100%|██████████| 18/18 [00:04<00:00,  4.20it/s]
                   all        548      38759      0.491      0.363      0.372      0.217
  0%|          | 0/405 [00:00<?, ?it/s]
      Epoch    GPU_mem   box_loss   cls_loss   dfl_loss  Instances       Size
      30/80        10G      1.262     0.8639     0.8954        422        640: 100%|██████████| 405/405 [01:33<00:00,  4.35it/s]
                 Class     Images  Instances      Box(P          R      mAP50  mAP50-95): 100%|██████████| 18/18 [00:04<00:00,  4.25it/s]
                   all        548      38759      0.487      0.371       0.38      0.224

      Epoch    GPU_mem   box_loss   cls_loss   dfl_loss  Instances       Size
      31/80      8.74G      1.263     0.8606     0.8947        543        640: 100%|██████████| 405/405 [01:33<00:00,  4.35it/s]
                 Class     Images  Instances      Box(P          R      mAP50  mAP50-95): 100%|██████████| 18/18 [00:04<00:00,  4.24it/s]
                   all        548      38759      0.479      0.374      0.381      0.224
  0%|          | 0/405 [00:00<?, ?it/s]
      Epoch    GPU_mem   box_loss   cls_loss   dfl_loss  Instances       Size
      32/80      7.99G      1.261     0.8591     0.8944        494        640: 100%|██████████| 405/405 [01:32<00:00,  4.36it/s]
                 Class     Images  Instances      Box(P          R      mAP50  mAP50-95): 100%|██████████| 18/18 [00:04<00:00,  4.28it/s]
                   all        548      38759       0.48      0.362      0.375      0.222
  0%|          | 0/405 [00:00<?, ?it/s]
      Epoch    GPU_mem   box_loss   cls_loss   dfl_loss  Instances       Size
      33/80      8.61G      1.257     0.8553     0.8928        393        640: 100%|██████████| 405/405 [01:32<00:00,  4.36it/s]
                 Class     Images  Instances      Box(P          R      mAP50  mAP50-95): 100%|██████████| 18/18 [00:04<00:00,  4.28it/s]
                   all        548      38759      0.485      0.373      0.381      0.225

      Epoch    GPU_mem   box_loss   cls_loss   dfl_loss  Instances       Size
      34/80      7.79G      1.254     0.8479     0.8926        564        640: 100%|██████████| 405/405 [01:33<00:00,  4.35it/s]
                 Class     Images  Instances      Box(P          R      mAP50  mAP50-95): 100%|██████████| 18/18 [00:04<00:00,  4.30it/s]
                   all        548      38759      0.498      0.375      0.385      0.229
  0%|          | 0/405 [00:00<?, ?it/s]
      Epoch    GPU_mem   box_loss   cls_loss   dfl_loss  Instances       Size
      35/80      8.52G      1.248     0.8422     0.8925        498        640: 100%|██████████| 405/405 [01:33<00:00,  4.34it/s]
                 Class     Images  Instances      Box(P          R      mAP50  mAP50-95): 100%|██████████| 18/18 [00:04<00:00,  4.25it/s]
                   all        548      38759      0.492      0.377      0.385      0.229
  0%|          | 0/405 [00:00<?, ?it/s]
      Epoch    GPU_mem   box_loss   cls_loss   dfl_loss  Instances       Size
      36/80      7.47G      1.241     0.8365     0.8903        587        640: 100%|██████████| 405/405 [01:33<00:00,  4.35it/s]
                 Class     Images  Instances      Box(P          R      mAP50  mAP50-95): 100%|██████████| 18/18 [00:04<00:00,  4.21it/s]
                   all        548      38759      0.497      0.372      0.384      0.227
  0%|          | 0/405 [00:00<?, ?it/s]
      Epoch    GPU_mem   box_loss   cls_loss   dfl_loss  Instances       Size
      37/80      10.4G      1.243     0.8382       0.89        634        640: 100%|██████████| 405/405 [01:33<00:00,  4.34it/s]
                 Class     Images  Instances      Box(P          R      mAP50  mAP50-95): 100%|██████████| 18/18 [00:04<00:00,  4.12it/s]
                   all        548      38759        0.5      0.381      0.392      0.232
  0%|          | 0/405 [00:00<?, ?it/s]
      Epoch    GPU_mem   box_loss   cls_loss   dfl_loss  Instances       Size
      38/80      9.83G      1.237     0.8309     0.8893        701        640: 100%|██████████| 405/405 [01:33<00:00,  4.35it/s]
                 Class     Images  Instances      Box(P          R      mAP50  mAP50-95): 100%|██████████| 18/18 [00:04<00:00,  4.29it/s]
                   all        548      38759        0.5      0.376      0.385      0.228
  0%|          | 0/405 [00:00<?, ?it/s]
      Epoch    GPU_mem   box_loss   cls_loss   dfl_loss  Instances       Size
      39/80      8.61G      1.245     0.8318     0.8889        604        640: 100%|██████████| 405/405 [01:33<00:00,  4.34it/s]
                 Class     Images  Instances      Box(P          R      mAP50  mAP50-95): 100%|██████████| 18/18 [00:04<00:00,  4.29it/s]
                   all        548      38759      0.498      0.374      0.387      0.229
  0%|          | 0/405 [00:00<?, ?it/s]
      Epoch    GPU_mem   box_loss   cls_loss   dfl_loss  Instances       Size
      40/80      9.83G      1.237     0.8267       0.89        691        640: 100%|██████████| 405/405 [01:32<00:00,  4.37it/s]
                 Class     Images  Instances      Box(P          R      mAP50  mAP50-95): 100%|██████████| 18/18 [00:04<00:00,  4.26it/s]
                   all        548      38759      0.498      0.378      0.387      0.229
  0%|          | 0/405 [00:00<?, ?it/s]
      Epoch    GPU_mem   box_loss   cls_loss   dfl_loss  Instances       Size
      41/80      10.9G      1.231     0.8183     0.8874        554        640: 100%|██████████| 405/405 [01:32<00:00,  4.36it/s]
                 Class     Images  Instances      Box(P          R      mAP50  mAP50-95): 100%|██████████| 18/18 [00:04<00:00,  4.24it/s]
                   all        548      38759      0.492      0.384      0.389       0.23

      Epoch    GPU_mem   box_loss   cls_loss   dfl_loss  Instances       Size
      42/80      9.51G      1.227     0.8149     0.8865        353        640: 100%|██████████| 405/405 [01:33<00:00,  4.35it/s]
                 Class     Images  Instances      Box(P          R      mAP50  mAP50-95): 100%|██████████| 18/18 [00:04<00:00,  4.31it/s]
                   all        548      38759      0.502      0.375      0.388       0.23
  0%|          | 0/405 [00:00<?, ?it/s]
      Epoch    GPU_mem   box_loss   cls_loss   dfl_loss  Instances       Size
      43/80      8.85G      1.226     0.8167     0.8859        446        640: 100%|██████████| 405/405 [01:32<00:00,  4.36it/s]
                 Class     Images  Instances      Box(P          R      mAP50  mAP50-95): 100%|██████████| 18/18 [00:04<00:00,  4.29it/s]
                   all        548      38759      0.494      0.379      0.387      0.229

      Epoch    GPU_mem   box_loss   cls_loss   dfl_loss  Instances       Size
      44/80      8.81G      1.221     0.8077     0.8844        957        640: 100%|██████████| 405/405 [01:32<00:00,  4.36it/s]
                 Class     Images  Instances      Box(P          R      mAP50  mAP50-95): 100%|██████████| 18/18 [00:04<00:00,  4.29it/s]
                   all        548      38759      0.487      0.383      0.391      0.232
  0%|          | 0/405 [00:00<?, ?it/s]
      Epoch    GPU_mem   box_loss   cls_loss   dfl_loss  Instances       Size
      45/80      9.22G      1.218     0.8035     0.8844        568        640: 100%|██████████| 405/405 [01:32<00:00,  4.36it/s]
                 Class     Images  Instances      Box(P          R      mAP50  mAP50-95): 100%|██████████| 18/18 [00:04<00:00,  4.28it/s]
                   all        548      38759      0.485      0.385       0.39      0.232

      Epoch    GPU_mem   box_loss   cls_loss   dfl_loss  Instances       Size
      46/80      10.1G      1.214     0.7988     0.8837        506        640: 100%|██████████| 405/405 [01:32<00:00,  4.36it/s]
                 Class     Images  Instances      Box(P          R      mAP50  mAP50-95): 100%|██████████| 18/18 [00:04<00:00,  4.19it/s]
                   all        548      38759      0.491      0.384       0.39      0.232
  0%|          | 0/405 [00:00<?, ?it/s]
      Epoch    GPU_mem   box_loss   cls_loss   dfl_loss  Instances       Size
      47/80      13.2G      1.214     0.7962     0.8843        616        640: 100%|██████████| 405/405 [01:40<00:00,  4.05it/s]
                 Class     Images  Instances      Box(P          R      mAP50  mAP50-95): 100%|██████████| 18/18 [00:04<00:00,  4.29it/s]
                   all        548      38759      0.484      0.386      0.388       0.23
  0%|          | 0/405 [00:00<?, ?it/s]
      Epoch    GPU_mem   box_loss   cls_loss   dfl_loss  Instances       Size
      48/80      12.1G      1.214     0.7956     0.8845       1312        640: 100%|██████████| 405/405 [01:37<00:00,  4.15it/s]
                 Class     Images  Instances      Box(P          R      mAP50  mAP50-95): 100%|██████████| 18/18 [00:04<00:00,  4.29it/s]
                   all        548      38759      0.498      0.381      0.391      0.231
  0%|          | 0/405 [00:00<?, ?it/s]
      Epoch    GPU_mem   box_loss   cls_loss   dfl_loss  Instances       Size
      49/80      10.9G       1.21     0.7897     0.8833        588        640: 100%|██████████| 405/405 [01:33<00:00,  4.35it/s]
                 Class     Images  Instances      Box(P          R      mAP50  mAP50-95): 100%|██████████| 18/18 [00:04<00:00,  4.30it/s]
                   all        548      38759      0.495      0.379      0.391      0.232
  0%|          | 0/405 [00:00<?, ?it/s]
      Epoch    GPU_mem   box_loss   cls_loss   dfl_loss  Instances       Size
      50/80      10.7G      1.208     0.7851     0.8831        434        640: 100%|██████████| 405/405 [01:33<00:00,  4.34it/s]
                 Class     Images  Instances      Box(P          R      mAP50  mAP50-95): 100%|██████████| 18/18 [00:04<00:00,  4.28it/s]
                   all        548      38759      0.504       0.38      0.392      0.233
  0%|          | 0/405 [00:00<?, ?it/s]
      Epoch    GPU_mem   box_loss   cls_loss   dfl_loss  Instances       Size
      51/80      10.4G      1.209     0.7861     0.8816        673        640: 100%|██████████| 405/405 [01:32<00:00,  4.36it/s]
                 Class     Images  Instances      Box(P          R      mAP50  mAP50-95): 100%|██████████| 18/18 [00:04<00:00,  4.23it/s]
                   all        548      38759      0.498       0.38      0.391      0.231
  0%|          | 0/405 [00:00<?, ?it/s]
      Epoch    GPU_mem   box_loss   cls_loss   dfl_loss  Instances       Size
      52/80      12.2G        1.2     0.7801     0.8825        436        640: 100%|██████████| 405/405 [01:35<00:00,  4.22it/s]
                 Class     Images  Instances      Box(P          R      mAP50  mAP50-95): 100%|██████████| 18/18 [00:04<00:00,  4.31it/s]
                   all        548      38759      0.486      0.387      0.392      0.232
  0%|          | 0/405 [00:00<?, ?it/s]
      Epoch    GPU_mem   box_loss   cls_loss   dfl_loss  Instances       Size
      53/80      10.3G      1.202     0.7788     0.8812        593        640: 100%|██████████| 405/405 [01:33<00:00,  4.35it/s]
                 Class     Images  Instances      Box(P          R      mAP50  mAP50-95): 100%|██████████| 18/18 [00:04<00:00,  4.30it/s]
                   all        548      38759      0.512      0.378      0.393      0.233
  0%|          | 0/405 [00:00<?, ?it/s]
      Epoch    GPU_mem   box_loss   cls_loss   dfl_loss  Instances       Size
      54/80      12.1G      1.196     0.7726     0.8799        618        640: 100%|██████████| 405/405 [02:25<00:00,  2.78it/s]
                 Class     Images  Instances      Box(P          R      mAP50  mAP50-95): 100%|██████████| 18/18 [00:09<00:00,  1.90it/s]
                   all        548      38759      0.509      0.382      0.393      0.231
  0%|          | 0/405 [00:00<?, ?it/s]
      Epoch    GPU_mem   box_loss   cls_loss   dfl_loss  Instances       Size
      55/80      7.17G      1.189      0.766     0.8791        846        640: 100%|██████████| 405/405 [01:32<00:00,  4.36it/s]
                 Class     Images  Instances      Box(P          R      mAP50  mAP50-95): 100%|██████████| 18/18 [00:04<00:00,  4.26it/s]
                   all        548      38759      0.497      0.388      0.395      0.234
  0%|          | 0/405 [00:00<?, ?it/s]
      Epoch    GPU_mem   box_loss   cls_loss   dfl_loss  Instances       Size
      56/80      8.14G      1.191     0.7663     0.8789        822        640: 100%|██████████| 405/405 [01:32<00:00,  4.36it/s]
                 Class     Images  Instances      Box(P          R      mAP50  mAP50-95): 100%|██████████| 18/18 [00:04<00:00,  4.34it/s]
                   all        548      38759      0.504      0.382      0.392      0.233
  0%|          | 0/405 [00:00<?, ?it/s]
      Epoch    GPU_mem   box_loss   cls_loss   dfl_loss  Instances       Size
      57/80      8.59G      1.194     0.7641     0.8793        709        640: 100%|██████████| 405/405 [01:33<00:00,  4.34it/s]
                 Class     Images  Instances      Box(P          R      mAP50  mAP50-95): 100%|██████████| 18/18 [00:04<00:00,  4.33it/s]
                   all        548      38759      0.504      0.385      0.393      0.233
  0%|          | 0/405 [00:00<?, ?it/s]
      Epoch    GPU_mem   box_loss   cls_loss   dfl_loss  Instances       Size
      58/80      7.88G      1.185     0.7569     0.8778        442        640: 100%|██████████| 405/405 [01:33<00:00,  4.35it/s]
                 Class     Images  Instances      Box(P          R      mAP50  mAP50-95): 100%|██████████| 18/18 [00:04<00:00,  4.31it/s]
                   all        548      38759      0.501      0.387      0.393      0.233
  0%|          | 0/405 [00:00<?, ?it/s]
      Epoch    GPU_mem   box_loss   cls_loss   dfl_loss  Instances       Size
      59/80       9.3G      1.183     0.7544     0.8774        438        640: 100%|██████████| 405/405 [01:32<00:00,  4.36it/s]
                 Class     Images  Instances      Box(P          R      mAP50  mAP50-95): 100%|██████████| 18/18 [00:04<00:00,  4.26it/s]
                   all        548      38759      0.502      0.386      0.393      0.234

      Epoch    GPU_mem   box_loss   cls_loss   dfl_loss  Instances       Size
      60/80      9.22G       1.18      0.751     0.8758        747        640: 100%|██████████| 405/405 [01:33<00:00,  4.35it/s]
                 Class     Images  Instances      Box(P          R      mAP50  mAP50-95): 100%|██████████| 18/18 [00:04<00:00,  4.32it/s]
                   all        548      38759      0.508       0.39      0.396      0.236
  0%|          | 0/405 [00:00<?, ?it/s]
      Epoch    GPU_mem   box_loss   cls_loss   dfl_loss  Instances       Size
      61/80      12.1G      1.178     0.7461     0.8762        627        640: 100%|██████████| 405/405 [01:35<00:00,  4.26it/s]
                 Class     Images  Instances      Box(P          R      mAP50  mAP50-95): 100%|██████████| 18/18 [00:04<00:00,  4.33it/s]
                   all        548      38759      0.511      0.383      0.396      0.235

      Epoch    GPU_mem   box_loss   cls_loss   dfl_loss  Instances       Size
      62/80      12.2G      1.178     0.7471     0.8773        521        640: 100%|██████████| 405/405 [01:35<00:00,  4.24it/s]
                 Class     Images  Instances      Box(P          R      mAP50  mAP50-95): 100%|██████████| 18/18 [00:04<00:00,  4.31it/s]
                   all        548      38759        0.5      0.388      0.394      0.234
  0%|          | 0/405 [00:00<?, ?it/s]
      Epoch    GPU_mem   box_loss   cls_loss   dfl_loss  Instances       Size
      63/80      9.48G      1.173     0.7435     0.8744        427        640: 100%|██████████| 405/405 [01:33<00:00,  4.35it/s]
                 Class     Images  Instances      Box(P          R      mAP50  mAP50-95): 100%|██████████| 18/18 [00:04<00:00,  4.32it/s]
                   all        548      38759      0.503      0.385      0.394      0.233
  0%|          | 0/405 [00:00<?, ?it/s]
      Epoch    GPU_mem   box_loss   cls_loss   dfl_loss  Instances       Size
      64/80      8.46G      1.173     0.7368     0.8756        389        640: 100%|██████████| 405/405 [01:32<00:00,  4.36it/s]
                 Class     Images  Instances      Box(P          R      mAP50  mAP50-95): 100%|██████████| 18/18 [00:04<00:00,  4.25it/s]
                   all        548      38759      0.511      0.385      0.395      0.233

      Epoch    GPU_mem   box_loss   cls_loss   dfl_loss  Instances       Size
      65/80      6.55G      1.169     0.7365     0.8748        550        640: 100%|██████████| 405/405 [01:32<00:00,  4.37it/s]
                 Class     Images  Instances      Box(P          R      mAP50  mAP50-95): 100%|██████████| 18/18 [00:04<00:00,  4.37it/s]
                   all        548      38759      0.494      0.389      0.393      0.233
  0%|          | 0/405 [00:00<?, ?it/s]
      Epoch    GPU_mem   box_loss   cls_loss   dfl_loss  Instances       Size
      66/80      8.44G      1.172     0.7366     0.8746        704        640: 100%|██████████| 405/405 [01:33<00:00,  4.34it/s]
                 Class     Images  Instances      Box(P          R      mAP50  mAP50-95): 100%|██████████| 18/18 [00:04<00:00,  4.27it/s]
                   all        548      38759      0.504      0.379      0.394      0.233
  0%|          | 0/405 [00:00<?, ?it/s]
      Epoch    GPU_mem   box_loss   cls_loss   dfl_loss  Instances       Size
      67/80      7.32G      1.164       0.73     0.8738        413        640: 100%|██████████| 405/405 [01:32<00:00,  4.36it/s]
                 Class     Images  Instances      Box(P          R      mAP50  mAP50-95): 100%|██████████| 18/18 [00:04<00:00,  4.29it/s]
                   all        548      38759      0.499       0.38      0.393      0.232

      Epoch    GPU_mem   box_loss   cls_loss   dfl_loss  Instances       Size
      68/80      9.54G      1.166     0.7258     0.8733        499        640: 100%|██████████| 405/405 [01:33<00:00,  4.34it/s]
                 Class     Images  Instances      Box(P          R      mAP50  mAP50-95): 100%|██████████| 18/18 [00:04<00:00,  4.26it/s]
                   all        548      38759      0.493      0.385      0.394      0.232
  0%|          | 0/405 [00:00<?, ?it/s]
      Epoch    GPU_mem   box_loss   cls_loss   dfl_loss  Instances       Size
      69/80      9.96G      1.162     0.7246     0.8724        691        640: 100%|██████████| 405/405 [01:33<00:00,  4.34it/s]
                 Class     Images  Instances      Box(P          R      mAP50  mAP50-95): 100%|██████████| 18/18 [00:04<00:00,  4.28it/s]
                   all        548      38759      0.506      0.385      0.396      0.234
  0%|          | 0/405 [00:00<?, ?it/s]
      Epoch    GPU_mem   box_loss   cls_loss   dfl_loss  Instances       Size
      70/80      7.83G      1.152     0.7175     0.8715        596        640: 100%|██████████| 405/405 [01:32<00:00,  4.37it/s]
                 Class     Images  Instances      Box(P          R      mAP50  mAP50-95): 100%|██████████| 18/18 [00:04<00:00,  4.32it/s]
                   all        548      38759        0.5      0.383      0.395      0.235
Closing dataloader mosaic
  0%|          | 0/405 [00:00<?, ?it/s]
      Epoch    GPU_mem   box_loss   cls_loss   dfl_loss  Instances       Size
      71/80      10.1G      1.139     0.7015     0.8726        439        640: 100%|██████████| 405/405 [01:28<00:00,  4.58it/s]
                 Class     Images  Instances      Box(P          R      mAP50  mAP50-95): 100%|██████████| 18/18 [00:04<00:00,  4.33it/s]
                   all        548      38759      0.504      0.376      0.392      0.233

      Epoch    GPU_mem   box_loss   cls_loss   dfl_loss  Instances       Size
      72/80      9.19G      1.134     0.6939     0.8703        345        640: 100%|██████████| 405/405 [01:28<00:00,  4.58it/s]
                 Class     Images  Instances      Box(P          R      mAP50  mAP50-95): 100%|██████████| 18/18 [00:04<00:00,  4.28it/s]
                   all        548      38759      0.508      0.378      0.392      0.232

      Epoch    GPU_mem   box_loss   cls_loss   dfl_loss  Instances       Size
      73/80      11.9G      1.126     0.6842     0.8695        252        640: 100%|██████████| 405/405 [01:29<00:00,  4.53it/s]
                 Class     Images  Instances      Box(P          R      mAP50  mAP50-95): 100%|██████████| 18/18 [00:04<00:00,  4.39it/s]
                   all        548      38759      0.499      0.383      0.392      0.232

      Epoch    GPU_mem   box_loss   cls_loss   dfl_loss  Instances       Size
      74/80      10.6G      1.123     0.6812     0.8702        187        640: 100%|██████████| 405/405 [01:28<00:00,  4.60it/s]
                 Class     Images  Instances      Box(P          R      mAP50  mAP50-95): 100%|██████████| 18/18 [00:04<00:00,  4.14it/s]
                   all        548      38759      0.506      0.378      0.392      0.232
  0%|          | 0/405 [00:00<?, ?it/s]
      Epoch    GPU_mem   box_loss   cls_loss   dfl_loss  Instances       Size
      75/80      9.38G      1.117     0.6748     0.8673        308        640: 100%|██████████| 405/405 [01:28<00:00,  4.57it/s]
                 Class     Images  Instances      Box(P          R      mAP50  mAP50-95): 100%|██████████| 18/18 [00:04<00:00,  3.91it/s]
                   all        548      38759      0.502       0.38      0.393      0.232

      Epoch    GPU_mem   box_loss   cls_loss   dfl_loss  Instances       Size
      76/80        10G      1.118     0.6742     0.8675        467        640: 100%|██████████| 405/405 [01:29<00:00,  4.51it/s]
                 Class     Images  Instances      Box(P          R      mAP50  mAP50-95): 100%|██████████| 18/18 [00:04<00:00,  3.95it/s]
                   all        548      38759      0.504      0.378      0.393      0.232
  0%|          | 0/405 [00:00<?, ?it/s]
      Epoch    GPU_mem   box_loss   cls_loss   dfl_loss  Instances       Size
      77/80      8.48G      1.113     0.6707     0.8676        491        640: 100%|██████████| 405/405 [01:28<00:00,  4.60it/s]
                 Class     Images  Instances      Box(P          R      mAP50  mAP50-95): 100%|██████████| 18/18 [00:04<00:00,  4.21it/s]
                   all        548      38759      0.502      0.379      0.392      0.232

      Epoch    GPU_mem   box_loss   cls_loss   dfl_loss  Instances       Size
      78/80      9.28G      1.113     0.6702     0.8669        374        640: 100%|██████████| 405/405 [01:28<00:00,  4.60it/s]
                 Class     Images  Instances      Box(P          R      mAP50  mAP50-95): 100%|██████████| 18/18 [00:04<00:00,  4.12it/s]
                   all        548      38759      0.499      0.381      0.393      0.232
  0%|          | 0/405 [00:00<?, ?it/s]
      Epoch    GPU_mem   box_loss   cls_loss   dfl_loss  Instances       Size
      79/80      8.01G      1.111     0.6649     0.8661        571        640: 100%|██████████| 405/405 [01:29<00:00,  4.54it/s]
                 Class     Images  Instances      Box(P          R      mAP50  mAP50-95): 100%|██████████| 18/18 [00:04<00:00,  4.05it/s]
                   all        548      38759      0.504      0.379      0.393      0.232

      Epoch    GPU_mem   box_loss   cls_loss   dfl_loss  Instances       Size
      80/80       8.3G      1.113      0.667     0.8653        324        640: 100%|██████████| 405/405 [01:28<00:00,  4.55it/s]
                 Class     Images  Instances      Box(P          R      mAP50  mAP50-95): 100%|██████████| 18/18 [00:04<00:00,  4.29it/s]
                   all        548      38759      0.505      0.379      0.393      0.232
EarlyStopping: Training stopped early as no improvement observed in last 20 epochs. Best results observed at epoch 60, best model saved as best.pt.
To update EarlyStopping(patience=20) pass a new patience value, i.e. `patience=300` or use `patience=0` to disable EarlyStopping.

80 epochs completed in 2.190 hours.
Optimizer stripped from D:\Project\VisDrone_Experiment\runs\ema\weights\last.pt, 22.5MB
Optimizer stripped from D:\Project\VisDrone_Experiment\runs\ema\weights\best.pt, 22.5MB

Validating D:\Project\VisDrone_Experiment\runs\ema\weights\best.pt...
Ultralytics 8.3.146  Python-3.9.13 torch-2.2.2+cu118 CUDA:0 (NVIDIA GeForce RTX 3060, 12288MiB)
Model summary (fused): 72 layers, 11,129,454 parameters, 0 gradients, 28.5 GFLOPs
                 Class     Images  Instances      Box(P          R      mAP50  mAP50-95): 100%|██████████| 18/18 [00:13<00:00,  1.34it/s]
                   all        548      38759      0.507       0.39      0.396      0.236
Speed: 0.1ms preprocess, 2.2ms inference, 0.0ms loss, 1.5ms postprocess per image
Results saved to D:\Project\VisDrone_Experiment\runs\ema
🧹 清理hook完成
✅ 训练完成
开始评估...
Ultralytics 8.3.146  Python-3.9.13 torch-2.2.2+cu118 CUDA:0 (NVIDIA GeForce RTX 3060, 12288MiB)
Model summary (fused): 72 layers, 11,129,454 parameters, 0 gradients, 28.5 GFLOPs
val: Fast image access  (ping: 0.10.0 ms, read: 1276.4335.5 MB/s, size: 153.1 KB)
val: Scanning D:\Project\VisDrone_Experiment\VisDrone2019-DET\labels\val.cache... 548 images, 0 backgrounds, 0 corrupt: 100%|██████████| 548/548 [00:00<?, ?it/s]
                 Class     Images  Instances      Box(P          R      mAP50  mAP50-95): 100%|██████████| 35/35 [00:15<00:00,  2.19it/s]
                   all        548      38759      0.517      0.395      0.402      0.237
Speed: 0.3ms preprocess, 5.5ms inference, 0.0ms loss, 4.9ms postprocess per image
Results saved to D:\VoiceRecognition\VoiceprintRecognition-Pytorch\runs\detect\val2
❌ 评估失败: 'Metric' object has no attribute 'precision'. See valid attributes below.

    Class for computing evaluation metrics for Ultralytics YOLO models.

    Attributes:
        p (list): Precision for each class. Shape: (nc,).
        r (list): Recall for each class. Shape: (nc,).
        f1 (list): F1 score for each class. Shape: (nc,).
        all_ap (list): AP scores for all classes and all IoU thresholds. Shape: (nc, 10).
        ap_class_index (list): Index of class for each AP score. Shape: (nc,).
        nc (int): Number of classes.

    Methods:
        ap50(): AP at IoU threshold of 0.5 for all classes. Returns: List of AP scores. Shape: (nc,) or [].
        ap(): AP at IoU thresholds from 0.5 to 0.95 for all classes. Returns: List of AP scores. Shape: (nc,) or [].
        mp(): Mean precision of all classes. Returns: Float.
        mr(): Mean recall of all classes. Returns: Float.
        map50(): Mean AP at IoU threshold of 0.5 for all classes. Returns: Float.
        map75(): Mean AP at IoU threshold of 0.75 for all classes. Returns: Float.
        map(): Mean AP at IoU thresholds from 0.5 to 0.95 for all classes. Returns: Float.
        mean_results(): Mean of results, returns mp, mr, map50, map.
        class_result(i): Class-aware result, returns p[i], r[i], ap50[i], ap[i].
        maps(): mAP of each class. Returns: Array of mAP scores, shape: (nc,).
        fitness(): Model fitness as a weighted combination of metrics. Returns: Float.
        update(results): Update metric attributes with new evaluation results.


🎯 实验 bifpn: YOLOv8s + BiFPN
--------------------------------------------------
开始训练...
🔧 集成BiFPN特征金字塔...
✅ BiFPN集成完成
Ultralytics 8.3.146  Python-3.9.13 torch-2.2.2+cu118 CUDA:0 (NVIDIA GeForce RTX 3060, 12288MiB)
engine\trainer: agnostic_nms=False, amp=True, augment=False, auto_augment=randaugment, batch=16, bgr=0.0, box=7.5, cache=False, cfg=None, classes=None, close_mosaic=10, cls=0.5, conf=None, copy_paste=0.0, copy_paste_mode=flip, cos_lr=False, cutmix=0.0, data=D:\Project\VisDrone_Experiment\configs\dataset\visdrone.yaml, degrees=0.0, deterministic=True, device=0, dfl=1.5, dnn=False, dropout=0.0, dynamic=False, embed=None, epochs=80, erasing=0.4, exist_ok=True, fliplr=0.5, flipud=0.0, format=torchscript, fraction=1.0, freeze=None, half=False, hsv_h=0.015, hsv_s=0.7, hsv_v=0.4, imgsz=640, int8=False, iou=0.7, keras=False, kobj=1.0, line_width=None, lr0=0.01, lrf=0.01, mask_ratio=4, max_det=300, mixup=0.0, mode=train, model=yolov8s.pt, momentum=0.937, mosaic=1.0, multi_scale=False, name=bifpn, nbs=64, nms=False, opset=None, optimize=False, optimizer=auto, overlap_mask=True, patience=20, perspective=0.0, plots=True, pose=12.0, pretrained=True, profile=False, project=D:\Project\VisDrone_Experiment\runs, rect=False, resume=False, retina_masks=False, save=True, save_conf=False, save_crop=False, save_dir=D:\Project\VisDrone_Experiment\runs\bifpn, save_frames=False, save_json=False, save_period=-1, save_txt=False, scale=0.5, seed=0, shear=0.0, show=False, show_boxes=True, show_conf=True, show_labels=True, simplify=True, single_cls=False, source=None, split=val, stream_buffer=False, task=detect, time=None, tracker=botsort.yaml, translate=0.1, val=True, verbose=False, vid_stride=1, visualize=False, warmup_bias_lr=0.1, warmup_epochs=3.0, warmup_momentum=0.8, weight_decay=0.0005, workers=4, workspace=None
Overriding model.yaml nc=80 with nc=10

                   from  n    params  module                                       arguments
  0                  -1  1       928  ultralytics.nn.modules.conv.Conv             [3, 32, 3, 2]
  1                  -1  1     18560  ultralytics.nn.modules.conv.Conv             [32, 64, 3, 2]
  2                  -1  1     29056  ultralytics.nn.modules.block.C2f             [64, 64, 1, True]
  3                  -1  1     73984  ultralytics.nn.modules.conv.Conv             [64, 128, 3, 2]
  4                  -1  2    197632  ultralytics.nn.modules.block.C2f             [128, 128, 2, True]
  5                  -1  1    295424  ultralytics.nn.modules.conv.Conv             [128, 256, 3, 2]
  6                  -1  2    788480  ultralytics.nn.modules.block.C2f             [256, 256, 2, True]
  7                  -1  1   1180672  ultralytics.nn.modules.conv.Conv             [256, 512, 3, 2]
  8                  -1  1   1838080  ultralytics.nn.modules.block.C2f             [512, 512, 1, True]
  9                  -1  1    656896  ultralytics.nn.modules.block.SPPF            [512, 512, 5]
 10                  -1  1         0  torch.nn.modules.upsampling.Upsample         [None, 2, 'nearest']
 11             [-1, 6]  1         0  ultralytics.nn.modules.conv.Concat           [1]
 12                  -1  1    591360  ultralytics.nn.modules.block.C2f             [768, 256, 1]
 13                  -1  1         0  torch.nn.modules.upsampling.Upsample         [None, 2, 'nearest']
 14             [-1, 4]  1         0  ultralytics.nn.modules.conv.Concat           [1]
 15                  -1  1    148224  ultralytics.nn.modules.block.C2f             [384, 128, 1]
 16                  -1  1    147712  ultralytics.nn.modules.conv.Conv             [128, 128, 3, 2]
 17            [-1, 12]  1         0  ultralytics.nn.modules.conv.Concat           [1]
 18                  -1  1    493056  ultralytics.nn.modules.block.C2f             [384, 256, 1]
 19                  -1  1    590336  ultralytics.nn.modules.conv.Conv             [256, 256, 3, 2]
 20             [-1, 9]  1         0  ultralytics.nn.modules.conv.Concat           [1]
 21                  -1  1   1969152  ultralytics.nn.modules.block.C2f             [768, 512, 1]
 22        [15, 18, 21]  1   2119918  ultralytics.nn.modules.head.Detect           [10, [128, 256, 512]]
Model summary: 129 layers, 11,139,470 parameters, 11,139,454 gradients, 28.7 GFLOPs

Transferred 349/355 items from pretrained weights
Freezing layer 'model.22.dfl.conv.weight'
AMP: running Automatic Mixed Precision (AMP) checks...
AMP: checks passed
train: Fast image access  (ping: 0.10.0 ms, read: 1795.8960.7 MB/s, size: 261.9 KB)
train: Scanning D:\Project\VisDrone_Experiment\VisDrone2019-DET\labels\train.cache... 6471 images, 0 backgrounds, 0 corrupt: 100%|██████████| 6471/6471 [00:00<?, ?it/s]
train: D:\Project\VisDrone_Experiment\VisDrone2019-DET\images\train\0000137_02220_d_0000163.jpg: 1 duplicate labels removed
train: D:\Project\VisDrone_Experiment\VisDrone2019-DET\images\train\0000140_00118_d_0000002.jpg: 1 duplicate labels removed
train: D:\Project\VisDrone_Experiment\VisDrone2019-DET\images\train\9999945_00000_d_0000114.jpg: 1 duplicate labels removed
train: D:\Project\VisDrone_Experiment\VisDrone2019-DET\images\train\9999987_00000_d_0000049.jpg: 1 duplicate labels removed
val: Fast image access  (ping: 0.10.0 ms, read: 1097.4261.5 MB/s, size: 131.6 KB)
val: Scanning D:\Project\VisDrone_Experiment\VisDrone2019-DET\labels\val.cache... 548 images, 0 backgrounds, 0 corrupt: 100%|██████████| 548/548 [00:00<?, ?it/s]
Plotting labels to D:\Project\VisDrone_Experiment\runs\bifpn\labels.jpg...
optimizer: 'optimizer=auto' found, ignoring 'lr0=0.01' and 'momentum=0.937' and determining best 'optimizer', 'lr0' and 'momentum' automatically...
optimizer: AdamW(lr=0.000714, momentum=0.9) with parameter groups 57 weight(decay=0.0), 64 weight(decay=0.0005), 63 bias(decay=0.0)
Image sizes 640 train, 640 val
Using 4 dataloader workers
Logging results to D:\Project\VisDrone_Experiment\runs\bifpn
Starting training for 80 epochs...

      Epoch    GPU_mem   box_loss   cls_loss   dfl_loss  Instances       Size
       1/80      10.8G      1.567      1.713     0.9978        674        640: 100%|██████████| 405/405 [01:36<00:00,  4.18it/s]
                 Class     Images  Instances      Box(P          R      mAP50  mAP50-95): 100%|██████████| 18/18 [00:04<00:00,  3.88it/s]
                   all        548      38759      0.316      0.256      0.235      0.134
  0%|          | 0/405 [00:00<?, ?it/s]
      Epoch    GPU_mem   box_loss   cls_loss   dfl_loss  Instances       Size
       2/80        10G      1.482      1.201     0.9536        872        640: 100%|██████████| 405/405 [01:34<00:00,  4.28it/s]
                 Class     Images  Instances      Box(P          R      mAP50  mAP50-95): 100%|██████████| 18/18 [00:04<00:00,  3.92it/s]
                   all        548      38759      0.352       0.26      0.243      0.139

      Epoch    GPU_mem   box_loss   cls_loss   dfl_loss  Instances       Size
       3/80      11.7G      1.463      1.163     0.9503        409        640: 100%|██████████| 405/405 [01:34<00:00,  4.27it/s]
                 Class     Images  Instances      Box(P          R      mAP50  mAP50-95): 100%|██████████| 18/18 [00:04<00:00,  3.92it/s]
                   all        548      38759      0.371      0.293      0.271      0.156
  0%|          | 0/405 [00:00<?, ?it/s]
      Epoch    GPU_mem   box_loss   cls_loss   dfl_loss  Instances       Size
       4/80      9.39G      1.448       1.13     0.9425        610        640: 100%|██████████| 405/405 [01:33<00:00,  4.34it/s]
                 Class     Images  Instances      Box(P          R      mAP50  mAP50-95): 100%|██████████| 18/18 [00:04<00:00,  4.13it/s]
                   all        548      38759      0.388      0.301      0.283      0.164

      Epoch    GPU_mem   box_loss   cls_loss   dfl_loss  Instances       Size
       5/80      8.55G      1.426      1.091     0.9377        591        640: 100%|██████████| 405/405 [01:32<00:00,  4.36it/s]
                 Class     Images  Instances      Box(P          R      mAP50  mAP50-95): 100%|██████████| 18/18 [00:04<00:00,  4.22it/s]
                   all        548      38759      0.413      0.306        0.3      0.172

      Epoch    GPU_mem   box_loss   cls_loss   dfl_loss  Instances       Size
       6/80      9.25G      1.414      1.072     0.9339        466        640: 100%|██████████| 405/405 [01:33<00:00,  4.34it/s]
                 Class     Images  Instances      Box(P          R      mAP50  mAP50-95): 100%|██████████| 18/18 [00:04<00:00,  4.14it/s]
                   all        548      38759      0.403      0.311        0.3      0.174
  0%|          | 0/405 [00:00<?, ?it/s]
      Epoch    GPU_mem   box_loss   cls_loss   dfl_loss  Instances       Size
       7/80      8.47G      1.398       1.05      0.931        274        640: 100%|██████████| 405/405 [01:32<00:00,  4.37it/s]
                 Class     Images  Instances      Box(P          R      mAP50  mAP50-95): 100%|██████████| 18/18 [00:04<00:00,  4.22it/s]
                   all        548      38759      0.414      0.316      0.309      0.178

      Epoch    GPU_mem   box_loss   cls_loss   dfl_loss  Instances       Size
       8/80      7.65G      1.382      1.032     0.9253        335        640: 100%|██████████| 405/405 [01:32<00:00,  4.36it/s]
                 Class     Images  Instances      Box(P          R      mAP50  mAP50-95): 100%|██████████| 18/18 [00:04<00:00,  4.22it/s]
                   all        548      38759       0.41      0.335      0.322      0.186
  0%|          | 0/405 [00:00<?, ?it/s]
      Epoch    GPU_mem   box_loss   cls_loss   dfl_loss  Instances       Size
       9/80      10.4G      1.378      1.022     0.9241        646        640: 100%|██████████| 405/405 [01:33<00:00,  4.33it/s]
                 Class     Images  Instances      Box(P          R      mAP50  mAP50-95): 100%|██████████| 18/18 [00:04<00:00,  4.14it/s]
                   all        548      38759      0.448      0.322      0.326      0.189

      Epoch    GPU_mem   box_loss   cls_loss   dfl_loss  Instances       Size
      10/80      10.7G      1.359      1.003     0.9209        634        640: 100%|██████████| 405/405 [01:33<00:00,  4.34it/s]
                 Class     Images  Instances      Box(P          R      mAP50  mAP50-95): 100%|██████████| 18/18 [00:04<00:00,  4.22it/s]
                   all        548      38759      0.429      0.329      0.327      0.189

      Epoch    GPU_mem   box_loss   cls_loss   dfl_loss  Instances       Size
      11/80      9.71G      1.357     0.9957     0.9194        505        640: 100%|██████████| 405/405 [01:33<00:00,  4.34it/s]
                 Class     Images  Instances      Box(P          R      mAP50  mAP50-95): 100%|██████████| 18/18 [00:04<00:00,  4.19it/s]
                   all        548      38759      0.452      0.318      0.325      0.189
  0%|          | 0/405 [00:00<?, ?it/s]
      Epoch    GPU_mem   box_loss   cls_loss   dfl_loss  Instances       Size
      12/80      5.86G      1.344     0.9814     0.9169        629        640: 100%|██████████| 405/405 [01:32<00:00,  4.37it/s]
                 Class     Images  Instances      Box(P          R      mAP50  mAP50-95): 100%|██████████| 18/18 [00:04<00:00,  4.20it/s]
                   all        548      38759      0.461      0.326      0.334      0.194
  0%|          | 0/405 [00:00<?, ?it/s]
      Epoch    GPU_mem   box_loss   cls_loss   dfl_loss  Instances       Size
      13/80      8.02G      1.347     0.9754     0.9182        706        640: 100%|██████████| 405/405 [01:33<00:00,  4.34it/s]
                 Class     Images  Instances      Box(P          R      mAP50  mAP50-95): 100%|██████████| 18/18 [00:04<00:00,  4.17it/s]
                   all        548      38759      0.445      0.343      0.341      0.199
  0%|          | 0/405 [00:00<?, ?it/s]
      Epoch    GPU_mem   box_loss   cls_loss   dfl_loss  Instances       Size
      14/80      9.43G      1.336     0.9604     0.9135        475        640: 100%|██████████| 405/405 [01:33<00:00,  4.34it/s]
                 Class     Images  Instances      Box(P          R      mAP50  mAP50-95): 100%|██████████| 18/18 [00:04<00:00,  4.21it/s]
                   all        548      38759      0.452      0.349       0.35      0.205

      Epoch    GPU_mem   box_loss   cls_loss   dfl_loss  Instances       Size
      15/80      12.2G       1.34     0.9597      0.913        648        640: 100%|██████████| 405/405 [01:36<00:00,  4.22it/s]
                 Class     Images  Instances      Box(P          R      mAP50  mAP50-95): 100%|██████████| 18/18 [00:04<00:00,  4.25it/s]
                   all        548      38759       0.46      0.346      0.352      0.204

      Epoch    GPU_mem   box_loss   cls_loss   dfl_loss  Instances       Size
      16/80      5.97G      1.329     0.9508       0.91        774        640: 100%|██████████| 405/405 [01:33<00:00,  4.35it/s]
                 Class     Images  Instances      Box(P          R      mAP50  mAP50-95): 100%|██████████| 18/18 [00:04<00:00,  4.28it/s]
                   all        548      38759      0.464      0.341      0.347        0.2

      Epoch    GPU_mem   box_loss   cls_loss   dfl_loss  Instances       Size
      17/80      6.95G      1.319     0.9416     0.9092        353        640: 100%|██████████| 405/405 [01:32<00:00,  4.37it/s]
                 Class     Images  Instances      Box(P          R      mAP50  mAP50-95): 100%|██████████| 18/18 [00:04<00:00,  4.24it/s]
                   all        548      38759      0.468      0.343      0.351      0.205
  0%|          | 0/405 [00:00<?, ?it/s]
      Epoch    GPU_mem   box_loss   cls_loss   dfl_loss  Instances       Size
      18/80       9.8G       1.32     0.9374     0.9085        669        640: 100%|██████████| 405/405 [01:33<00:00,  4.34it/s]
                 Class     Images  Instances      Box(P          R      mAP50  mAP50-95): 100%|██████████| 18/18 [00:04<00:00,  4.20it/s]
                   all        548      38759      0.469      0.353      0.359      0.211

      Epoch    GPU_mem   box_loss   cls_loss   dfl_loss  Instances       Size
      19/80      8.65G      1.311     0.9297     0.9062        818        640: 100%|██████████| 405/405 [01:32<00:00,  4.36it/s]
                 Class     Images  Instances      Box(P          R      mAP50  mAP50-95): 100%|██████████| 18/18 [00:04<00:00,  4.22it/s]
                   all        548      38759      0.467       0.36      0.361      0.211
  0%|          | 0/405 [00:00<?, ?it/s]
      Epoch    GPU_mem   box_loss   cls_loss   dfl_loss  Instances       Size
      20/80      9.06G      1.306     0.9179     0.9047        494        640: 100%|██████████| 405/405 [01:33<00:00,  4.34it/s]
                 Class     Images  Instances      Box(P          R      mAP50  mAP50-95): 100%|██████████| 18/18 [00:04<00:00,  4.20it/s]
                   all        548      38759      0.462      0.354      0.355      0.208

      Epoch    GPU_mem   box_loss   cls_loss   dfl_loss  Instances       Size
      21/80      9.14G      1.298     0.9113     0.9035        307        640: 100%|██████████| 405/405 [01:33<00:00,  4.35it/s]
                 Class     Images  Instances      Box(P          R      mAP50  mAP50-95): 100%|██████████| 18/18 [00:04<00:00,  4.28it/s]
                   all        548      38759      0.477      0.357      0.364      0.214

      Epoch    GPU_mem   box_loss   cls_loss   dfl_loss  Instances       Size
      22/80      8.81G      1.305     0.9122     0.9037        359        640: 100%|██████████| 405/405 [01:33<00:00,  4.35it/s]
                 Class     Images  Instances      Box(P          R      mAP50  mAP50-95): 100%|██████████| 18/18 [00:04<00:00,  4.21it/s]
                   all        548      38759      0.463      0.362      0.364      0.213
  0%|          | 0/405 [00:00<?, ?it/s]
      Epoch    GPU_mem   box_loss   cls_loss   dfl_loss  Instances       Size
      23/80      10.1G      1.302     0.9114     0.9033        595        640: 100%|██████████| 405/405 [01:32<00:00,  4.36it/s]
                 Class     Images  Instances      Box(P          R      mAP50  mAP50-95): 100%|██████████| 18/18 [00:04<00:00,  4.22it/s]
                   all        548      38759       0.47      0.368      0.366      0.214
  0%|          | 0/405 [00:00<?, ?it/s]
      Epoch    GPU_mem   box_loss   cls_loss   dfl_loss  Instances       Size
      24/80      10.5G      1.289     0.8991      0.901        793        640: 100%|██████████| 405/405 [01:32<00:00,  4.36it/s]
                 Class     Images  Instances      Box(P          R      mAP50  mAP50-95): 100%|██████████| 18/18 [00:04<00:00,  4.23it/s]
                   all        548      38759      0.467      0.362      0.368      0.219
  0%|          | 0/405 [00:00<?, ?it/s]
      Epoch    GPU_mem   box_loss   cls_loss   dfl_loss  Instances       Size
      25/80      9.41G      1.278     0.8848     0.8995        555        640: 100%|██████████| 405/405 [01:33<00:00,  4.34it/s]
                 Class     Images  Instances      Box(P          R      mAP50  mAP50-95): 100%|██████████| 18/18 [00:04<00:00,  4.23it/s]
                   all        548      38759      0.484      0.361       0.37      0.219
  0%|          | 0/405 [00:00<?, ?it/s]
      Epoch    GPU_mem   box_loss   cls_loss   dfl_loss  Instances       Size
      26/80      8.87G      1.285     0.8924     0.9004        510        640: 100%|██████████| 405/405 [01:33<00:00,  4.35it/s]
                 Class     Images  Instances      Box(P          R      mAP50  mAP50-95): 100%|██████████| 18/18 [00:04<00:00,  4.24it/s]
                   all        548      38759      0.493      0.363      0.374      0.219

      Epoch    GPU_mem   box_loss   cls_loss   dfl_loss  Instances       Size
      27/80       7.9G      1.277     0.8849     0.8981        404        640: 100%|██████████| 405/405 [01:33<00:00,  4.35it/s]
                 Class     Images  Instances      Box(P          R      mAP50  mAP50-95): 100%|██████████| 18/18 [00:04<00:00,  4.21it/s]
                   all        548      38759       0.48      0.368      0.375      0.221
  0%|          | 0/405 [00:00<?, ?it/s]
      Epoch    GPU_mem   box_loss   cls_loss   dfl_loss  Instances       Size
      28/80      9.35G      1.273     0.8754     0.8976        877        640: 100%|██████████| 405/405 [01:33<00:00,  4.35it/s]
                 Class     Images  Instances      Box(P          R      mAP50  mAP50-95): 100%|██████████| 18/18 [00:04<00:00,  4.24it/s]
                   all        548      38759      0.478      0.366      0.375      0.221
  0%|          | 0/405 [00:00<?, ?it/s]
      Epoch    GPU_mem   box_loss   cls_loss   dfl_loss  Instances       Size
      29/80      7.88G      1.268     0.8718      0.896        456        640: 100%|██████████| 405/405 [01:33<00:00,  4.35it/s]
                 Class     Images  Instances      Box(P          R      mAP50  mAP50-95): 100%|██████████| 18/18 [00:04<00:00,  4.27it/s]
                   all        548      38759      0.491      0.363      0.372      0.217

      Epoch    GPU_mem   box_loss   cls_loss   dfl_loss  Instances       Size
      30/80        10G      1.262     0.8639     0.8954        422        640: 100%|██████████| 405/405 [01:32<00:00,  4.36it/s]
                 Class     Images  Instances      Box(P          R      mAP50  mAP50-95): 100%|██████████| 18/18 [00:04<00:00,  4.27it/s]
                   all        548      38759      0.487      0.371       0.38      0.224
  0%|          | 0/405 [00:00<?, ?it/s]
      Epoch    GPU_mem   box_loss   cls_loss   dfl_loss  Instances       Size
      31/80      8.73G      1.263     0.8606     0.8947        543        640: 100%|██████████| 405/405 [01:32<00:00,  4.36it/s]
                 Class     Images  Instances      Box(P          R      mAP50  mAP50-95): 100%|██████████| 18/18 [00:04<00:00,  4.26it/s]
                   all        548      38759      0.479      0.374      0.381      0.224

      Epoch    GPU_mem   box_loss   cls_loss   dfl_loss  Instances       Size
      32/80      7.99G      1.261     0.8591     0.8944        494        640: 100%|██████████| 405/405 [01:33<00:00,  4.35it/s]
                 Class     Images  Instances      Box(P          R      mAP50  mAP50-95): 100%|██████████| 18/18 [00:04<00:00,  4.29it/s]
                   all        548      38759       0.48      0.362      0.375      0.222

      Epoch    GPU_mem   box_loss   cls_loss   dfl_loss  Instances       Size
      33/80      8.62G      1.257     0.8553     0.8928        393        640: 100%|██████████| 405/405 [01:32<00:00,  4.36it/s]
                 Class     Images  Instances      Box(P          R      mAP50  mAP50-95): 100%|██████████| 18/18 [00:04<00:00,  4.25it/s]
                   all        548      38759      0.485      0.373      0.381      0.225
  0%|          | 0/405 [00:00<?, ?it/s]
      Epoch    GPU_mem   box_loss   cls_loss   dfl_loss  Instances       Size
      34/80      7.81G      1.254     0.8479     0.8926        564        640: 100%|██████████| 405/405 [01:32<00:00,  4.36it/s]
                 Class     Images  Instances      Box(P          R      mAP50  mAP50-95): 100%|██████████| 18/18 [00:04<00:00,  4.27it/s]
                   all        548      38759      0.498      0.375      0.385      0.229

      Epoch    GPU_mem   box_loss   cls_loss   dfl_loss  Instances       Size
      35/80      8.53G      1.248     0.8422     0.8925        498        640: 100%|██████████| 405/405 [01:33<00:00,  4.35it/s]
                 Class     Images  Instances      Box(P          R      mAP50  mAP50-95): 100%|██████████| 18/18 [00:04<00:00,  4.24it/s]
                   all        548      38759      0.492      0.377      0.385      0.229
  0%|          | 0/405 [00:00<?, ?it/s]
      Epoch    GPU_mem   box_loss   cls_loss   dfl_loss  Instances       Size
      36/80      7.49G      1.241     0.8365     0.8903        587        640: 100%|██████████| 405/405 [01:33<00:00,  4.35it/s]
                 Class     Images  Instances      Box(P          R      mAP50  mAP50-95): 100%|██████████| 18/18 [00:04<00:00,  4.22it/s]
                   all        548      38759      0.497      0.372      0.384      0.227
  0%|          | 0/405 [00:00<?, ?it/s]
      Epoch    GPU_mem   box_loss   cls_loss   dfl_loss  Instances       Size
      37/80      10.4G      1.243     0.8382       0.89        634        640: 100%|██████████| 405/405 [01:33<00:00,  4.34it/s]
                 Class     Images  Instances      Box(P          R      mAP50  mAP50-95): 100%|██████████| 18/18 [00:04<00:00,  4.32it/s]
                   all        548      38759        0.5      0.381      0.392      0.232
  0%|          | 0/405 [00:00<?, ?it/s]
      Epoch    GPU_mem   box_loss   cls_loss   dfl_loss  Instances       Size
      38/80      9.83G      1.237     0.8309     0.8893        701        640: 100%|██████████| 405/405 [01:33<00:00,  4.35it/s]
                 Class     Images  Instances      Box(P          R      mAP50  mAP50-95): 100%|██████████| 18/18 [00:04<00:00,  4.18it/s]
                   all        548      38759        0.5      0.376      0.385      0.228
  0%|          | 0/405 [00:00<?, ?it/s]
      Epoch    GPU_mem   box_loss   cls_loss   dfl_loss  Instances       Size
      39/80       8.6G      1.245     0.8318     0.8889        604        640: 100%|██████████| 405/405 [01:33<00:00,  4.34it/s]
                 Class     Images  Instances      Box(P          R      mAP50  mAP50-95): 100%|██████████| 18/18 [00:04<00:00,  4.23it/s]
                   all        548      38759      0.498      0.374      0.387      0.229
  0%|          | 0/405 [00:00<?, ?it/s]
      Epoch    GPU_mem   box_loss   cls_loss   dfl_loss  Instances       Size
      40/80      9.84G      1.237     0.8267       0.89        691        640: 100%|██████████| 405/405 [01:32<00:00,  4.36it/s]
                 Class     Images  Instances      Box(P          R      mAP50  mAP50-95): 100%|██████████| 18/18 [00:04<00:00,  4.25it/s]
                   all        548      38759      0.498      0.378      0.387      0.229
  0%|          | 0/405 [00:00<?, ?it/s]
      Epoch    GPU_mem   box_loss   cls_loss   dfl_loss  Instances       Size
      41/80      10.9G      1.231     0.8183     0.8874        554        640: 100%|██████████| 405/405 [01:33<00:00,  4.35it/s]
                 Class     Images  Instances      Box(P          R      mAP50  mAP50-95): 100%|██████████| 18/18 [00:04<00:00,  4.26it/s]
                   all        548      38759      0.492      0.384      0.389       0.23

      Epoch    GPU_mem   box_loss   cls_loss   dfl_loss  Instances       Size
      42/80      9.51G      1.227     0.8149     0.8865        353        640: 100%|██████████| 405/405 [01:33<00:00,  4.35it/s]
                 Class     Images  Instances      Box(P          R      mAP50  mAP50-95): 100%|██████████| 18/18 [00:04<00:00,  4.35it/s]
                   all        548      38759      0.502      0.375      0.388       0.23
  0%|          | 0/405 [00:00<?, ?it/s]
      Epoch    GPU_mem   box_loss   cls_loss   dfl_loss  Instances       Size
      43/80      8.86G      1.226     0.8167     0.8859        446        640: 100%|██████████| 405/405 [01:32<00:00,  4.36it/s]
                 Class     Images  Instances      Box(P          R      mAP50  mAP50-95): 100%|██████████| 18/18 [00:04<00:00,  4.28it/s]
                   all        548      38759      0.494      0.379      0.387      0.229
  0%|          | 0/405 [00:00<?, ?it/s]
      Epoch    GPU_mem   box_loss   cls_loss   dfl_loss  Instances       Size
      44/80      8.83G      1.221     0.8077     0.8844        957        640: 100%|██████████| 405/405 [01:33<00:00,  4.35it/s]
                 Class     Images  Instances      Box(P          R      mAP50  mAP50-95): 100%|██████████| 18/18 [00:04<00:00,  4.24it/s]
                   all        548      38759      0.487      0.383      0.391      0.232
  0%|          | 0/405 [00:00<?, ?it/s]
      Epoch    GPU_mem   box_loss   cls_loss   dfl_loss  Instances       Size
      45/80      9.21G      1.218     0.8035     0.8844        568        640: 100%|██████████| 405/405 [01:33<00:00,  4.35it/s]
                 Class     Images  Instances      Box(P          R      mAP50  mAP50-95): 100%|██████████| 18/18 [00:04<00:00,  4.29it/s]
                   all        548      38759      0.485      0.385       0.39      0.232
  0%|          | 0/405 [00:00<?, ?it/s]
      Epoch    GPU_mem   box_loss   cls_loss   dfl_loss  Instances       Size
      46/80      10.1G      1.214     0.7988     0.8837        506        640: 100%|██████████| 405/405 [01:32<00:00,  4.36it/s]
                 Class     Images  Instances      Box(P          R      mAP50  mAP50-95): 100%|██████████| 18/18 [00:04<00:00,  4.22it/s]
                   all        548      38759      0.491      0.384       0.39      0.232
  0%|          | 0/405 [00:00<?, ?it/s]
      Epoch    GPU_mem   box_loss   cls_loss   dfl_loss  Instances       Size
      47/80      13.2G      1.214     0.7962     0.8843        616        640: 100%|██████████| 405/405 [01:39<00:00,  4.06it/s]
                 Class     Images  Instances      Box(P          R      mAP50  mAP50-95): 100%|██████████| 18/18 [00:04<00:00,  4.32it/s]
                   all        548      38759      0.484      0.386      0.388       0.23
  0%|          | 0/405 [00:00<?, ?it/s]
      Epoch    GPU_mem   box_loss   cls_loss   dfl_loss  Instances       Size
      48/80      12.1G      1.214     0.7956     0.8845       1312        640: 100%|██████████| 405/405 [01:37<00:00,  4.17it/s]
                 Class     Images  Instances      Box(P          R      mAP50  mAP50-95): 100%|██████████| 18/18 [00:04<00:00,  4.34it/s]
                   all        548      38759      0.498      0.381      0.391      0.231

      Epoch    GPU_mem   box_loss   cls_loss   dfl_loss  Instances       Size
      49/80      10.9G       1.21     0.7897     0.8833        588        640: 100%|██████████| 405/405 [01:32<00:00,  4.36it/s]
                 Class     Images  Instances      Box(P          R      mAP50  mAP50-95): 100%|██████████| 18/18 [00:04<00:00,  4.27it/s]
                   all        548      38759      0.495      0.379      0.391      0.232

      Epoch    GPU_mem   box_loss   cls_loss   dfl_loss  Instances       Size
      50/80      10.7G      1.208     0.7851     0.8831        434        640: 100%|██████████| 405/405 [01:33<00:00,  4.34it/s]
                 Class     Images  Instances      Box(P          R      mAP50  mAP50-95): 100%|██████████| 18/18 [00:04<00:00,  4.26it/s]
                   all        548      38759      0.504       0.38      0.392      0.233
  0%|          | 0/405 [00:00<?, ?it/s]
      Epoch    GPU_mem   box_loss   cls_loss   dfl_loss  Instances       Size
      51/80      10.4G      1.209     0.7861     0.8816        673        640: 100%|██████████| 405/405 [01:33<00:00,  4.35it/s]
                 Class     Images  Instances      Box(P          R      mAP50  mAP50-95): 100%|██████████| 18/18 [00:04<00:00,  4.30it/s]
                   all        548      38759      0.498       0.38      0.391      0.231

      Epoch    GPU_mem   box_loss   cls_loss   dfl_loss  Instances       Size
      52/80      12.2G        1.2     0.7801     0.8825        436        640: 100%|██████████| 405/405 [01:35<00:00,  4.22it/s]
                 Class     Images  Instances      Box(P          R      mAP50  mAP50-95): 100%|██████████| 18/18 [00:04<00:00,  4.30it/s]
                   all        548      38759      0.486      0.387      0.392      0.232

      Epoch    GPU_mem   box_loss   cls_loss   dfl_loss  Instances       Size
      53/80      10.3G      1.202     0.7788     0.8812        593        640: 100%|██████████| 405/405 [01:33<00:00,  4.35it/s]
                 Class     Images  Instances      Box(P          R      mAP50  mAP50-95): 100%|██████████| 18/18 [00:04<00:00,  4.31it/s]
                   all        548      38759      0.512      0.378      0.393      0.233
  0%|          | 0/405 [00:00<?, ?it/s]
      Epoch    GPU_mem   box_loss   cls_loss   dfl_loss  Instances       Size
      54/80      12.1G      1.196     0.7726     0.8799        618        640: 100%|██████████| 405/405 [02:19<00:00,  2.89it/s]
                 Class     Images  Instances      Box(P          R      mAP50  mAP50-95): 100%|██████████| 18/18 [00:11<00:00,  1.52it/s]
                   all        548      38759      0.509      0.382      0.393      0.231

      Epoch    GPU_mem   box_loss   cls_loss   dfl_loss  Instances       Size
      55/80      7.19G      1.189      0.766     0.8791        846        640: 100%|██████████| 405/405 [01:32<00:00,  4.37it/s]
                 Class     Images  Instances      Box(P          R      mAP50  mAP50-95): 100%|██████████| 18/18 [00:04<00:00,  4.32it/s]
                   all        548      38759      0.497      0.388      0.395      0.234
  0%|          | 0/405 [00:00<?, ?it/s]
      Epoch    GPU_mem   box_loss   cls_loss   dfl_loss  Instances       Size
      56/80      8.15G      1.191     0.7663     0.8789        822        640: 100%|██████████| 405/405 [01:32<00:00,  4.36it/s]
                 Class     Images  Instances      Box(P          R      mAP50  mAP50-95): 100%|██████████| 18/18 [00:04<00:00,  4.29it/s]
                   all        548      38759      0.504      0.382      0.392      0.233

      Epoch    GPU_mem   box_loss   cls_loss   dfl_loss  Instances       Size
      57/80      8.59G      1.194     0.7641     0.8793        709        640: 100%|██████████| 405/405 [01:33<00:00,  4.33it/s]
                 Class     Images  Instances      Box(P          R      mAP50  mAP50-95): 100%|██████████| 18/18 [00:04<00:00,  4.35it/s]
                   all        548      38759      0.504      0.385      0.393      0.233

      Epoch    GPU_mem   box_loss   cls_loss   dfl_loss  Instances       Size
      58/80      7.88G      1.185     0.7569     0.8778        442        640: 100%|██████████| 405/405 [01:32<00:00,  4.36it/s]
                 Class     Images  Instances      Box(P          R      mAP50  mAP50-95): 100%|██████████| 18/18 [00:04<00:00,  4.30it/s]
                   all        548      38759      0.501      0.387      0.393      0.233

      Epoch    GPU_mem   box_loss   cls_loss   dfl_loss  Instances       Size
      59/80      9.32G      1.183     0.7544     0.8774        438        640: 100%|██████████| 405/405 [01:32<00:00,  4.37it/s]
                 Class     Images  Instances      Box(P          R      mAP50  mAP50-95): 100%|██████████| 18/18 [00:04<00:00,  4.27it/s]
                   all        548      38759      0.502      0.386      0.393      0.234

      Epoch    GPU_mem   box_loss   cls_loss   dfl_loss  Instances       Size
      60/80      9.23G       1.18      0.751     0.8758        747        640: 100%|██████████| 405/405 [01:33<00:00,  4.35it/s]
                 Class     Images  Instances      Box(P          R      mAP50  mAP50-95): 100%|██████████| 18/18 [00:04<00:00,  4.31it/s]
                   all        548      38759      0.508       0.39      0.396      0.236

      Epoch    GPU_mem   box_loss   cls_loss   dfl_loss  Instances       Size
      61/80        12G      1.178     0.7461     0.8762        627        640: 100%|██████████| 405/405 [01:35<00:00,  4.25it/s]
                 Class     Images  Instances      Box(P          R      mAP50  mAP50-95): 100%|██████████| 18/18 [00:04<00:00,  4.33it/s]
                   all        548      38759      0.511      0.383      0.396      0.235
  0%|          | 0/405 [00:00<?, ?it/s]
      Epoch    GPU_mem   box_loss   cls_loss   dfl_loss  Instances       Size
      62/80      12.2G      1.178     0.7471     0.8773        521        640: 100%|██████████| 405/405 [01:35<00:00,  4.24it/s]
                 Class     Images  Instances      Box(P          R      mAP50  mAP50-95): 100%|██████████| 18/18 [00:04<00:00,  4.30it/s]
                   all        548      38759        0.5      0.388      0.394      0.234

      Epoch    GPU_mem   box_loss   cls_loss   dfl_loss  Instances       Size
      63/80      9.47G      1.173     0.7435     0.8744        427        640: 100%|██████████| 405/405 [01:33<00:00,  4.35it/s]
                 Class     Images  Instances      Box(P          R      mAP50  mAP50-95): 100%|██████████| 18/18 [00:04<00:00,  4.29it/s]
                   all        548      38759      0.503      0.385      0.394      0.233
  0%|          | 0/405 [00:00<?, ?it/s]
      Epoch    GPU_mem   box_loss   cls_loss   dfl_loss  Instances       Size
      64/80      8.46G      1.173     0.7368     0.8756        389        640: 100%|██████████| 405/405 [01:32<00:00,  4.37it/s]
                 Class     Images  Instances      Box(P          R      mAP50  mAP50-95): 100%|██████████| 18/18 [00:04<00:00,  4.31it/s]
                   all        548      38759      0.511      0.385      0.395      0.233
  0%|          | 0/405 [00:00<?, ?it/s]
      Epoch    GPU_mem   box_loss   cls_loss   dfl_loss  Instances       Size
      65/80      6.55G      1.169     0.7365     0.8748        550        640: 100%|██████████| 405/405 [01:32<00:00,  4.37it/s]
                 Class     Images  Instances      Box(P          R      mAP50  mAP50-95): 100%|██████████| 18/18 [00:04<00:00,  4.29it/s]
                   all        548      38759      0.494      0.389      0.393      0.233

      Epoch    GPU_mem   box_loss   cls_loss   dfl_loss  Instances       Size
      66/80      8.44G      1.172     0.7366     0.8746        704        640: 100%|██████████| 405/405 [01:33<00:00,  4.34it/s]
                 Class     Images  Instances      Box(P          R      mAP50  mAP50-95): 100%|██████████| 18/18 [00:04<00:00,  4.30it/s]
                   all        548      38759      0.504      0.379      0.394      0.233

      Epoch    GPU_mem   box_loss   cls_loss   dfl_loss  Instances       Size
      67/80      7.32G      1.164       0.73     0.8738        413        640: 100%|██████████| 405/405 [01:32<00:00,  4.39it/s]
                 Class     Images  Instances      Box(P          R      mAP50  mAP50-95): 100%|██████████| 18/18 [00:04<00:00,  4.46it/s]
                   all        548      38759      0.499       0.38      0.393      0.232
  0%|          | 0/405 [00:00<?, ?it/s]
      Epoch    GPU_mem   box_loss   cls_loss   dfl_loss  Instances       Size
      68/80      9.56G      1.166     0.7258     0.8733        499        640: 100%|██████████| 405/405 [01:32<00:00,  4.38it/s]
                 Class     Images  Instances      Box(P          R      mAP50  mAP50-95): 100%|██████████| 18/18 [00:04<00:00,  4.47it/s]
                   all        548      38759      0.493      0.385      0.394      0.232
  0%|          | 0/405 [00:00<?, ?it/s]
      Epoch    GPU_mem   box_loss   cls_loss   dfl_loss  Instances       Size
      69/80      9.96G      1.162     0.7246     0.8724        691        640: 100%|██████████| 405/405 [01:32<00:00,  4.36it/s]
                 Class     Images  Instances      Box(P          R      mAP50  mAP50-95): 100%|██████████| 18/18 [00:04<00:00,  4.40it/s]
                   all        548      38759      0.506      0.385      0.396      0.234
  0%|          | 0/405 [00:00<?, ?it/s]
      Epoch    GPU_mem   box_loss   cls_loss   dfl_loss  Instances       Size
      70/80      7.83G      1.152     0.7175     0.8715        596        640: 100%|██████████| 405/405 [01:31<00:00,  4.41it/s]
                 Class     Images  Instances      Box(P          R      mAP50  mAP50-95): 100%|██████████| 18/18 [00:04<00:00,  4.41it/s]
                   all        548      38759        0.5      0.383      0.395      0.235
Closing dataloader mosaic
  0%|          | 0/405 [00:00<?, ?it/s]
      Epoch    GPU_mem   box_loss   cls_loss   dfl_loss  Instances       Size
      71/80      10.1G      1.139     0.7015     0.8726        439        640: 100%|██████████| 405/405 [01:27<00:00,  4.62it/s]
                 Class     Images  Instances      Box(P          R      mAP50  mAP50-95): 100%|██████████| 18/18 [00:04<00:00,  4.45it/s]
                   all        548      38759      0.504      0.376      0.392      0.233
  0%|          | 0/405 [00:00<?, ?it/s]
      Epoch    GPU_mem   box_loss   cls_loss   dfl_loss  Instances       Size
      72/80      9.19G      1.134     0.6939     0.8703        345        640: 100%|██████████| 405/405 [01:27<00:00,  4.64it/s]
                 Class     Images  Instances      Box(P          R      mAP50  mAP50-95): 100%|██████████| 18/18 [00:04<00:00,  4.39it/s]
                   all        548      38759      0.508      0.378      0.392      0.232
  0%|          | 0/405 [00:00<?, ?it/s]
      Epoch    GPU_mem   box_loss   cls_loss   dfl_loss  Instances       Size
      73/80      11.9G      1.126     0.6842     0.8695        252        640: 100%|██████████| 405/405 [01:29<00:00,  4.54it/s]
                 Class     Images  Instances      Box(P          R      mAP50  mAP50-95): 100%|██████████| 18/18 [00:04<00:00,  4.30it/s]
                   all        548      38759      0.499      0.383      0.392      0.232
  0%|          | 0/405 [00:00<?, ?it/s]
      Epoch    GPU_mem   box_loss   cls_loss   dfl_loss  Instances       Size
      74/80      10.6G      1.123     0.6812     0.8702        187        640: 100%|██████████| 405/405 [01:27<00:00,  4.61it/s]
                 Class     Images  Instances      Box(P          R      mAP50  mAP50-95): 100%|██████████| 18/18 [00:04<00:00,  4.30it/s]
                   all        548      38759      0.506      0.378      0.392      0.232

      Epoch    GPU_mem   box_loss   cls_loss   dfl_loss  Instances       Size
      75/80      9.39G      1.117     0.6748     0.8673        308        640: 100%|██████████| 405/405 [01:27<00:00,  4.63it/s]
                 Class     Images  Instances      Box(P          R      mAP50  mAP50-95): 100%|██████████| 18/18 [00:04<00:00,  4.32it/s]
                   all        548      38759      0.502       0.38      0.393      0.232
  0%|          | 0/405 [00:00<?, ?it/s]
      Epoch    GPU_mem   box_loss   cls_loss   dfl_loss  Instances       Size
      76/80        10G      1.118     0.6742     0.8675        467        640: 100%|██████████| 405/405 [01:27<00:00,  4.62it/s]
                 Class     Images  Instances      Box(P          R      mAP50  mAP50-95): 100%|██████████| 18/18 [00:04<00:00,  4.28it/s]
                   all        548      38759      0.504      0.378      0.393      0.232

      Epoch    GPU_mem   box_loss   cls_loss   dfl_loss  Instances       Size
      77/80       8.5G      1.113     0.6707     0.8676        491        640: 100%|██████████| 405/405 [01:27<00:00,  4.62it/s]
                 Class     Images  Instances      Box(P          R      mAP50  mAP50-95): 100%|██████████| 18/18 [00:04<00:00,  4.33it/s]
                   all        548      38759      0.502      0.379      0.392      0.232
  0%|          | 0/405 [00:00<?, ?it/s]
      Epoch    GPU_mem   box_loss   cls_loss   dfl_loss  Instances       Size
      78/80      9.28G      1.113     0.6702     0.8669        374        640: 100%|██████████| 405/405 [01:27<00:00,  4.61it/s]
                 Class     Images  Instances      Box(P          R      mAP50  mAP50-95): 100%|██████████| 18/18 [00:04<00:00,  4.30it/s]
                   all        548      38759      0.499      0.381      0.393      0.232
  0%|          | 0/405 [00:00<?, ?it/s]
      Epoch    GPU_mem   box_loss   cls_loss   dfl_loss  Instances       Size
      79/80      8.01G      1.111     0.6649     0.8661        571        640: 100%|██████████| 405/405 [01:27<00:00,  4.62it/s]
                 Class     Images  Instances      Box(P          R      mAP50  mAP50-95): 100%|██████████| 18/18 [00:04<00:00,  4.33it/s]
                   all        548      38759      0.504      0.379      0.393      0.232
  0%|          | 0/405 [00:00<?, ?it/s]
      Epoch    GPU_mem   box_loss   cls_loss   dfl_loss  Instances       Size
      80/80       8.3G      1.113      0.667     0.8653        324        640: 100%|██████████| 405/405 [01:27<00:00,  4.61it/s]
                 Class     Images  Instances      Box(P          R      mAP50  mAP50-95): 100%|██████████| 18/18 [00:04<00:00,  4.35it/s]
                   all        548      38759      0.505      0.379      0.393      0.232
EarlyStopping: Training stopped early as no improvement observed in last 20 epochs. Best results observed at epoch 60, best model saved as best.pt.
To update EarlyStopping(patience=20) pass a new patience value, i.e. `patience=300` or use `patience=0` to disable EarlyStopping.

80 epochs completed in 2.186 hours.
Optimizer stripped from D:\Project\VisDrone_Experiment\runs\bifpn\weights\last.pt, 22.5MB
Optimizer stripped from D:\Project\VisDrone_Experiment\runs\bifpn\weights\best.pt, 22.5MB

Validating D:\Project\VisDrone_Experiment\runs\bifpn\weights\best.pt...
Ultralytics 8.3.146  Python-3.9.13 torch-2.2.2+cu118 CUDA:0 (NVIDIA GeForce RTX 3060, 12288MiB)
Model summary (fused): 72 layers, 11,129,454 parameters, 0 gradients, 28.5 GFLOPs
                 Class     Images  Instances      Box(P          R      mAP50  mAP50-95): 100%|██████████| 18/18 [00:13<00:00,  1.33it/s]
                   all        548      38759      0.507       0.39      0.396      0.236
Speed: 0.1ms preprocess, 2.2ms inference, 0.0ms loss, 2.3ms postprocess per image
Results saved to D:\Project\VisDrone_Experiment\runs\bifpn
🧹 清理hook完成
✅ 训练完成
开始评估...
Ultralytics 8.3.146  Python-3.9.13 torch-2.2.2+cu118 CUDA:0 (NVIDIA GeForce RTX 3060, 12288MiB)
Model summary (fused): 72 layers, 11,129,454 parameters, 0 gradients, 28.5 GFLOPs
val: Fast image access  (ping: 0.10.0 ms, read: 998.6232.6 MB/s, size: 153.1 KB)
val: Scanning D:\Project\VisDrone_Experiment\VisDrone2019-DET\labels\val.cache... 548 images, 0 backgrounds, 0 corrupt: 100%|██████████| 548/548 [00:00<?, ?it/s]
                 Class     Images  Instances      Box(P          R      mAP50  mAP50-95): 100%|██████████| 35/35 [00:16<00:00,  2.16it/s]
                   all        548      38759      0.517      0.395      0.402      0.237
Speed: 0.3ms preprocess, 5.1ms inference, 0.0ms loss, 4.7ms postprocess per image
Results saved to D:\VoiceRecognition\VoiceprintRecognition-Pytorch\runs\detect\val3
❌ 评估失败: 'Metric' object has no attribute 'precision'. See valid attributes below.

    Class for computing evaluation metrics for Ultralytics YOLO models.

    Attributes:
        p (list): Precision for each class. Shape: (nc,).
        r (list): Recall for each class. Shape: (nc,).
        f1 (list): F1 score for each class. Shape: (nc,).
        all_ap (list): AP scores for all classes and all IoU thresholds. Shape: (nc, 10).
        ap_class_index (list): Index of class for each AP score. Shape: (nc,).
        nc (int): Number of classes.

    Methods:
        ap50(): AP at IoU threshold of 0.5 for all classes. Returns: List of AP scores. Shape: (nc,) or [].
        ap(): AP at IoU thresholds from 0.5 to 0.95 for all classes. Returns: List of AP scores. Shape: (nc,) or [].
        mp(): Mean precision of all classes. Returns: Float.
        mr(): Mean recall of all classes. Returns: Float.
        map50(): Mean AP at IoU threshold of 0.5 for all classes. Returns: Float.
        map75(): Mean AP at IoU threshold of 0.75 for all classes. Returns: Float.
        map(): Mean AP at IoU thresholds from 0.5 to 0.95 for all classes. Returns: Float.
        mean_results(): Mean of results, returns mp, mr, map50, map.
        class_result(i): Class-aware result, returns p[i], r[i], ap50[i], ap[i].
        maps(): mAP of each class. Returns: Array of mAP scores, shape: (nc,).
        fitness(): Model fitness as a weighted combination of metrics. Returns: Float.
        update(results): Update metric attributes with new evaluation results.


🎯 实验 full: YOLOv8s + EMA + BiFPN
--------------------------------------------------
开始训练...
🔧 集成完整模型...
🔧 集成EMA注意力机制...
✅ 在 model.4 添加EMA注意力 (通道数: 128)
✅ 在 model.6 添加EMA注意力 (通道数: 256)
✅ 在 model.9 添加EMA注意力 (通道数: 512)
✅ 添加了 3 个EMA注意力模块
🔧 集成BiFPN特征金字塔...
✅ BiFPN集成完成
✅ BiFPN集成: True
Ultralytics 8.3.146  Python-3.9.13 torch-2.2.2+cu118 CUDA:0 (NVIDIA GeForce RTX 3060, 12288MiB)
engine\trainer: agnostic_nms=False, amp=True, augment=False, auto_augment=randaugment, batch=16, bgr=0.0, box=7.5, cache=False, cfg=None, classes=None, close_mosaic=10, cls=0.5, conf=None, copy_paste=0.0, copy_paste_mode=flip, cos_lr=False, cutmix=0.0, data=D:\Project\VisDrone_Experiment\configs\dataset\visdrone.yaml, degrees=0.0, deterministic=True, device=0, dfl=1.5, dnn=False, dropout=0.0, dynamic=False, embed=None, epochs=80, erasing=0.4, exist_ok=True, fliplr=0.5, flipud=0.0, format=torchscript, fraction=1.0, freeze=None, half=False, hsv_h=0.015, hsv_s=0.7, hsv_v=0.4, imgsz=640, int8=False, iou=0.7, keras=False, kobj=1.0, line_width=None, lr0=0.01, lrf=0.01, mask_ratio=4, max_det=300, mixup=0.0, mode=train, model=yolov8s.pt, momentum=0.937, mosaic=1.0, multi_scale=False, name=full, nbs=64, nms=False, opset=None, optimize=False, optimizer=auto, overlap_mask=True, patience=20, perspective=0.0, plots=True, pose=12.0, pretrained=True, profile=False, project=D:\Project\VisDrone_Experiment\runs, rect=False, resume=False, retina_masks=False, save=True, save_conf=False, save_crop=False, save_dir=D:\Project\VisDrone_Experiment\runs\full, save_frames=False, save_json=False, save_period=-1, save_txt=False, scale=0.5, seed=0, shear=0.0, show=False, show_boxes=True, show_conf=True, show_labels=True, simplify=True, single_cls=False, source=None, split=val, stream_buffer=False, task=detect, time=None, tracker=botsort.yaml, translate=0.1, val=True, verbose=False, vid_stride=1, visualize=False, warmup_bias_lr=0.1, warmup_epochs=3.0, warmup_momentum=0.8, weight_decay=0.0005, workers=4, workspace=None
Overriding model.yaml nc=80 with nc=10

                   from  n    params  module                                       arguments
  0                  -1  1       928  ultralytics.nn.modules.conv.Conv             [3, 32, 3, 2]
  1                  -1  1     18560  ultralytics.nn.modules.conv.Conv             [32, 64, 3, 2]
  2                  -1  1     29056  ultralytics.nn.modules.block.C2f             [64, 64, 1, True]
  3                  -1  1     73984  ultralytics.nn.modules.conv.Conv             [64, 128, 3, 2]
  4                  -1  2    197632  ultralytics.nn.modules.block.C2f             [128, 128, 2, True]
  5                  -1  1    295424  ultralytics.nn.modules.conv.Conv             [128, 256, 3, 2]
  6                  -1  2    788480  ultralytics.nn.modules.block.C2f             [256, 256, 2, True]
  7                  -1  1   1180672  ultralytics.nn.modules.conv.Conv             [256, 512, 3, 2]
  8                  -1  1   1838080  ultralytics.nn.modules.block.C2f             [512, 512, 1, True]
  9                  -1  1    656896  ultralytics.nn.modules.block.SPPF            [512, 512, 5]
 10                  -1  1         0  torch.nn.modules.upsampling.Upsample         [None, 2, 'nearest']
 11             [-1, 6]  1         0  ultralytics.nn.modules.conv.Concat           [1]
 12                  -1  1    591360  ultralytics.nn.modules.block.C2f             [768, 256, 1]
 13                  -1  1         0  torch.nn.modules.upsampling.Upsample         [None, 2, 'nearest']
 14             [-1, 4]  1         0  ultralytics.nn.modules.conv.Concat           [1]
 15                  -1  1    148224  ultralytics.nn.modules.block.C2f             [384, 128, 1]
 16                  -1  1    147712  ultralytics.nn.modules.conv.Conv             [128, 128, 3, 2]
 17            [-1, 12]  1         0  ultralytics.nn.modules.conv.Concat           [1]
 18                  -1  1    493056  ultralytics.nn.modules.block.C2f             [384, 256, 1]
 19                  -1  1    590336  ultralytics.nn.modules.conv.Conv             [256, 256, 3, 2]
 20             [-1, 9]  1         0  ultralytics.nn.modules.conv.Concat           [1]
 21                  -1  1   1969152  ultralytics.nn.modules.block.C2f             [768, 512, 1]
 22        [15, 18, 21]  1   2119918  ultralytics.nn.modules.head.Detect           [10, [128, 256, 512]]
Model summary: 129 layers, 11,139,470 parameters, 11,139,454 gradients, 28.7 GFLOPs

Transferred 349/355 items from pretrained weights
Freezing layer 'model.22.dfl.conv.weight'
AMP: running Automatic Mixed Precision (AMP) checks...
AMP: checks passed
train: Fast image access  (ping: 0.10.0 ms, read: 1968.6914.0 MB/s, size: 261.9 KB)
train: Scanning D:\Project\VisDrone_Experiment\VisDrone2019-DET\labels\train.cache... 6471 images, 0 backgrounds, 0 corrupt: 100%|██████████| 6471/6471 [00:00<?, ?it/s]
train: D:\Project\VisDrone_Experiment\VisDrone2019-DET\images\train\0000137_02220_d_0000163.jpg: 1 duplicate labels removed
train: D:\Project\VisDrone_Experiment\VisDrone2019-DET\images\train\0000140_00118_d_0000002.jpg: 1 duplicate labels removed
train: D:\Project\VisDrone_Experiment\VisDrone2019-DET\images\train\9999945_00000_d_0000114.jpg: 1 duplicate labels removed
train: D:\Project\VisDrone_Experiment\VisDrone2019-DET\images\train\9999987_00000_d_0000049.jpg: 1 duplicate labels removed
val: Fast image access  (ping: 0.10.0 ms, read: 911.1218.1 MB/s, size: 131.6 KB)
val: Scanning D:\Project\VisDrone_Experiment\VisDrone2019-DET\labels\val.cache... 548 images, 0 backgrounds, 0 corrupt: 100%|██████████| 548/548 [00:00<?, ?it/s]
Plotting labels to D:\Project\VisDrone_Experiment\runs\full\labels.jpg...
optimizer: 'optimizer=auto' found, ignoring 'lr0=0.01' and 'momentum=0.937' and determining best 'optimizer', 'lr0' and 'momentum' automatically...
optimizer: AdamW(lr=0.000714, momentum=0.9) with parameter groups 57 weight(decay=0.0), 64 weight(decay=0.0005), 63 bias(decay=0.0)
Image sizes 640 train, 640 val
Using 4 dataloader workers
Logging results to D:\Project\VisDrone_Experiment\runs\full
Starting training for 80 epochs...

      Epoch    GPU_mem   box_loss   cls_loss   dfl_loss  Instances       Size
       1/80      10.8G      1.567      1.713     0.9978        674        640: 100%|██████████| 405/405 [01:36<00:00,  4.20it/s]
                 Class     Images  Instances      Box(P          R      mAP50  mAP50-95): 100%|██████████| 18/18 [00:04<00:00,  4.12it/s]
                   all        548      38759      0.316      0.256      0.235      0.134
  0%|          | 0/405 [00:00<?, ?it/s]
      Epoch    GPU_mem   box_loss   cls_loss   dfl_loss  Instances       Size
       2/80        10G      1.482      1.201     0.9536        872        640: 100%|██████████| 405/405 [01:34<00:00,  4.31it/s]
                 Class     Images  Instances      Box(P          R      mAP50  mAP50-95): 100%|██████████| 18/18 [00:04<00:00,  4.05it/s]
                   all        548      38759      0.352       0.26      0.243      0.139

      Epoch    GPU_mem   box_loss   cls_loss   dfl_loss  Instances       Size
       3/80      11.7G      1.463      1.163     0.9503        409        640: 100%|██████████| 405/405 [01:34<00:00,  4.28it/s]
                 Class     Images  Instances      Box(P          R      mAP50  mAP50-95): 100%|██████████| 18/18 [00:04<00:00,  4.16it/s]
                   all        548      38759      0.371      0.293      0.271      0.156
  0%|          | 0/405 [00:00<?, ?it/s]
      Epoch    GPU_mem   box_loss   cls_loss   dfl_loss  Instances       Size
       4/80      9.39G      1.448       1.13     0.9425        610        640: 100%|██████████| 405/405 [01:33<00:00,  4.35it/s]
                 Class     Images  Instances      Box(P          R      mAP50  mAP50-95): 100%|██████████| 18/18 [00:04<00:00,  4.14it/s]
                   all        548      38759      0.388      0.301      0.283      0.164

      Epoch    GPU_mem   box_loss   cls_loss   dfl_loss  Instances       Size
       5/80      8.55G      1.426      1.091     0.9377        591        640: 100%|██████████| 405/405 [01:32<00:00,  4.37it/s]
                 Class     Images  Instances      Box(P          R      mAP50  mAP50-95): 100%|██████████| 18/18 [00:04<00:00,  4.15it/s]
                   all        548      38759      0.413      0.306        0.3      0.172
  0%|          | 0/405 [00:00<?, ?it/s]
      Epoch    GPU_mem   box_loss   cls_loss   dfl_loss  Instances       Size
       6/80      9.26G      1.414      1.072     0.9339        466        640: 100%|██████████| 405/405 [01:33<00:00,  4.34it/s]
                 Class     Images  Instances      Box(P          R      mAP50  mAP50-95): 100%|██████████| 18/18 [00:04<00:00,  4.20it/s]
                   all        548      38759      0.403      0.311        0.3      0.174
  0%|          | 0/405 [00:00<?, ?it/s]
      Epoch    GPU_mem   box_loss   cls_loss   dfl_loss  Instances       Size
       7/80      8.49G      1.398       1.05      0.931        274        640: 100%|██████████| 405/405 [01:32<00:00,  4.37it/s]
                 Class     Images  Instances      Box(P          R      mAP50  mAP50-95): 100%|██████████| 18/18 [00:04<00:00,  4.22it/s]
                   all        548      38759      0.414      0.316      0.309      0.178
  0%|          | 0/405 [00:00<?, ?it/s]
      Epoch    GPU_mem   box_loss   cls_loss   dfl_loss  Instances       Size
       8/80      7.64G      1.382      1.032     0.9253        335        640: 100%|██████████| 405/405 [01:32<00:00,  4.36it/s]
                 Class     Images  Instances      Box(P          R      mAP50  mAP50-95): 100%|██████████| 18/18 [00:04<00:00,  4.19it/s]
                   all        548      38759       0.41      0.335      0.322      0.186
  0%|          | 0/405 [00:00<?, ?it/s]
      Epoch    GPU_mem   box_loss   cls_loss   dfl_loss  Instances       Size
       9/80      10.4G      1.378      1.022     0.9241        646        640: 100%|██████████| 405/405 [01:33<00:00,  4.34it/s]
                 Class     Images  Instances      Box(P          R      mAP50  mAP50-95): 100%|██████████| 18/18 [00:04<00:00,  4.11it/s]
                   all        548      38759      0.448      0.322      0.326      0.189

      Epoch    GPU_mem   box_loss   cls_loss   dfl_loss  Instances       Size
      10/80      10.7G      1.359      1.003     0.9209        634        640: 100%|██████████| 405/405 [01:33<00:00,  4.34it/s]
                 Class     Images  Instances      Box(P          R      mAP50  mAP50-95): 100%|██████████| 18/18 [00:04<00:00,  4.23it/s]
                   all        548      38759      0.429      0.329      0.327      0.189
  0%|          | 0/405 [00:00<?, ?it/s]
      Epoch    GPU_mem   box_loss   cls_loss   dfl_loss  Instances       Size
      11/80      9.71G      1.357     0.9957     0.9194        505        640: 100%|██████████| 405/405 [01:33<00:00,  4.35it/s]
                 Class     Images  Instances      Box(P          R      mAP50  mAP50-95): 100%|██████████| 18/18 [00:04<00:00,  4.20it/s]
                   all        548      38759      0.452      0.318      0.325      0.189
  0%|          | 0/405 [00:00<?, ?it/s]
      Epoch    GPU_mem   box_loss   cls_loss   dfl_loss  Instances       Size
      12/80      5.88G      1.344     0.9814     0.9169        629        640: 100%|██████████| 405/405 [01:32<00:00,  4.37it/s]
                 Class     Images  Instances      Box(P          R      mAP50  mAP50-95): 100%|██████████| 18/18 [00:04<00:00,  4.23it/s]
                   all        548      38759      0.461      0.326      0.334      0.194

      Epoch    GPU_mem   box_loss   cls_loss   dfl_loss  Instances       Size
      13/80      8.04G      1.347     0.9754     0.9182        706        640: 100%|██████████| 405/405 [01:33<00:00,  4.33it/s]
                 Class     Images  Instances      Box(P          R      mAP50  mAP50-95): 100%|██████████| 18/18 [00:04<00:00,  4.21it/s]
                   all        548      38759      0.445      0.343      0.341      0.199
  0%|          | 0/405 [00:00<?, ?it/s]
      Epoch    GPU_mem   box_loss   cls_loss   dfl_loss  Instances       Size
      14/80      9.43G      1.336     0.9604     0.9135        475        640: 100%|██████████| 405/405 [01:33<00:00,  4.34it/s]
                 Class     Images  Instances      Box(P          R      mAP50  mAP50-95): 100%|██████████| 18/18 [00:04<00:00,  4.22it/s]
                   all        548      38759      0.452      0.349       0.35      0.205
  0%|          | 0/405 [00:00<?, ?it/s]
      Epoch    GPU_mem   box_loss   cls_loss   dfl_loss  Instances       Size
      15/80      12.3G       1.34     0.9597      0.913        648        640: 100%|██████████| 405/405 [01:36<00:00,  4.20it/s]
                 Class     Images  Instances      Box(P          R      mAP50  mAP50-95): 100%|██████████| 18/18 [00:04<00:00,  4.18it/s]
                   all        548      38759       0.46      0.346      0.352      0.204

      Epoch    GPU_mem   box_loss   cls_loss   dfl_loss  Instances       Size
      16/80      5.98G      1.329     0.9508       0.91        774        640: 100%|██████████| 405/405 [01:33<00:00,  4.34it/s]
                 Class     Images  Instances      Box(P          R      mAP50  mAP50-95): 100%|██████████| 18/18 [00:04<00:00,  4.27it/s]
                   all        548      38759      0.464      0.341      0.347        0.2

      Epoch    GPU_mem   box_loss   cls_loss   dfl_loss  Instances       Size
      17/80      6.95G      1.319     0.9416     0.9092        353        640: 100%|██████████| 405/405 [01:32<00:00,  4.38it/s]
                 Class     Images  Instances      Box(P          R      mAP50  mAP50-95): 100%|██████████| 18/18 [00:04<00:00,  4.22it/s]
                   all        548      38759      0.468      0.343      0.351      0.205

      Epoch    GPU_mem   box_loss   cls_loss   dfl_loss  Instances       Size
      18/80       9.8G       1.32     0.9374     0.9085        669        640: 100%|██████████| 405/405 [01:33<00:00,  4.34it/s]
                 Class     Images  Instances      Box(P          R      mAP50  mAP50-95): 100%|██████████| 18/18 [00:04<00:00,  4.21it/s]
                   all        548      38759      0.469      0.353      0.359      0.211
  0%|          | 0/405 [00:00<?, ?it/s]
      Epoch    GPU_mem   box_loss   cls_loss   dfl_loss  Instances       Size
      19/80      8.65G      1.311     0.9297     0.9062        818        640: 100%|██████████| 405/405 [01:32<00:00,  4.36it/s]
                 Class     Images  Instances      Box(P          R      mAP50  mAP50-95): 100%|██████████| 18/18 [00:04<00:00,  4.18it/s]
                   all        548      38759      0.467       0.36      0.361      0.211

      Epoch    GPU_mem   box_loss   cls_loss   dfl_loss  Instances       Size
      20/80      9.06G      1.306     0.9179     0.9047        494        640: 100%|██████████| 405/405 [01:33<00:00,  4.35it/s]
                 Class     Images  Instances      Box(P          R      mAP50  mAP50-95): 100%|██████████| 18/18 [00:04<00:00,  4.18it/s]
                   all        548      38759      0.462      0.354      0.355      0.208
  0%|          | 0/405 [00:00<?, ?it/s]
      Epoch    GPU_mem   box_loss   cls_loss   dfl_loss  Instances       Size
      21/80      9.13G      1.298     0.9113     0.9035        307        640: 100%|██████████| 405/405 [01:33<00:00,  4.34it/s]
                 Class     Images  Instances      Box(P          R      mAP50  mAP50-95): 100%|██████████| 18/18 [00:04<00:00,  4.28it/s]
                   all        548      38759      0.477      0.357      0.364      0.214
  0%|          | 0/405 [00:00<?, ?it/s]
      Epoch    GPU_mem   box_loss   cls_loss   dfl_loss  Instances       Size
      22/80       8.8G      1.305     0.9122     0.9037        359        640: 100%|██████████| 405/405 [01:32<00:00,  4.36it/s]
                 Class     Images  Instances      Box(P          R      mAP50  mAP50-95): 100%|██████████| 18/18 [00:04<00:00,  4.21it/s]
                   all        548      38759      0.463      0.362      0.364      0.213

      Epoch    GPU_mem   box_loss   cls_loss   dfl_loss  Instances       Size
      23/80      10.1G      1.302     0.9114     0.9033        595        640: 100%|██████████| 405/405 [01:33<00:00,  4.34it/s]
                 Class     Images  Instances      Box(P          R      mAP50  mAP50-95): 100%|██████████| 18/18 [00:04<00:00,  4.22it/s]
                   all        548      38759       0.47      0.368      0.366      0.214
  0%|          | 0/405 [00:00<?, ?it/s]
      Epoch    GPU_mem   box_loss   cls_loss   dfl_loss  Instances       Size
      24/80      10.5G      1.289     0.8991      0.901        793        640: 100%|██████████| 405/405 [01:32<00:00,  4.36it/s]
                 Class     Images  Instances      Box(P          R      mAP50  mAP50-95): 100%|██████████| 18/18 [00:04<00:00,  4.23it/s]
                   all        548      38759      0.467      0.362      0.368      0.219
  0%|          | 0/405 [00:00<?, ?it/s]
      Epoch    GPU_mem   box_loss   cls_loss   dfl_loss  Instances       Size
      25/80       9.4G      1.278     0.8848     0.8995        555        640: 100%|██████████| 405/405 [01:33<00:00,  4.34it/s]
                 Class     Images  Instances      Box(P          R      mAP50  mAP50-95): 100%|██████████| 18/18 [00:04<00:00,  4.31it/s]
                   all        548      38759      0.484      0.361       0.37      0.219
  0%|          | 0/405 [00:00<?, ?it/s]
      Epoch    GPU_mem   box_loss   cls_loss   dfl_loss  Instances       Size
      26/80      8.88G      1.285     0.8924     0.9004        510        640: 100%|██████████| 405/405 [01:33<00:00,  4.35it/s]
                 Class     Images  Instances      Box(P          R      mAP50  mAP50-95): 100%|██████████| 18/18 [00:04<00:00,  4.24it/s]
                   all        548      38759      0.493      0.363      0.374      0.219

      Epoch    GPU_mem   box_loss   cls_loss   dfl_loss  Instances       Size
      27/80      7.89G      1.277     0.8849     0.8981        404        640: 100%|██████████| 405/405 [01:33<00:00,  4.35it/s]
                 Class     Images  Instances      Box(P          R      mAP50  mAP50-95): 100%|██████████| 18/18 [00:04<00:00,  4.28it/s]
                   all        548      38759       0.48      0.368      0.375      0.221

      Epoch    GPU_mem   box_loss   cls_loss   dfl_loss  Instances       Size
      28/80      9.37G      1.273     0.8754     0.8976        877        640: 100%|██████████| 405/405 [01:33<00:00,  4.34it/s]
                 Class     Images  Instances      Box(P          R      mAP50  mAP50-95): 100%|██████████| 18/18 [00:04<00:00,  4.22it/s]
                   all        548      38759      0.478      0.366      0.375      0.221

      Epoch    GPU_mem   box_loss   cls_loss   dfl_loss  Instances       Size
      29/80      7.87G      1.268     0.8718      0.896        456        640: 100%|██████████| 405/405 [01:33<00:00,  4.34it/s]
                 Class     Images  Instances      Box(P          R      mAP50  mAP50-95): 100%|██████████| 18/18 [00:04<00:00,  4.20it/s]
                   all        548      38759      0.491      0.363      0.372      0.217

      Epoch    GPU_mem   box_loss   cls_loss   dfl_loss  Instances       Size
      30/80        10G      1.262     0.8639     0.8954        422        640: 100%|██████████| 405/405 [01:32<00:00,  4.36it/s]
                 Class     Images  Instances      Box(P          R      mAP50  mAP50-95): 100%|██████████| 18/18 [00:04<00:00,  4.26it/s]
                   all        548      38759      0.487      0.371       0.38      0.224

      Epoch    GPU_mem   box_loss   cls_loss   dfl_loss  Instances       Size
      31/80      8.74G      1.263     0.8606     0.8947        543        640: 100%|██████████| 405/405 [01:33<00:00,  4.35it/s]
                 Class     Images  Instances      Box(P          R      mAP50  mAP50-95): 100%|██████████| 18/18 [00:04<00:00,  4.25it/s]
                   all        548      38759      0.479      0.374      0.381      0.224

      Epoch    GPU_mem   box_loss   cls_loss   dfl_loss  Instances       Size
      32/80      7.98G      1.261     0.8591     0.8944        494        640: 100%|██████████| 405/405 [01:33<00:00,  4.35it/s]
                 Class     Images  Instances      Box(P          R      mAP50  mAP50-95): 100%|██████████| 18/18 [00:04<00:00,  4.29it/s]
                   all        548      38759       0.48      0.362      0.375      0.222
  0%|          | 0/405 [00:00<?, ?it/s]
      Epoch    GPU_mem   box_loss   cls_loss   dfl_loss  Instances       Size
      33/80       8.6G      1.257     0.8553     0.8928        393        640: 100%|██████████| 405/405 [01:32<00:00,  4.36it/s]
                 Class     Images  Instances      Box(P          R      mAP50  mAP50-95): 100%|██████████| 18/18 [00:04<00:00,  4.25it/s]
                   all        548      38759      0.485      0.373      0.381      0.225
  0%|          | 0/405 [00:00<?, ?it/s]
      Epoch    GPU_mem   box_loss   cls_loss   dfl_loss  Instances       Size
      34/80       7.8G      1.254     0.8479     0.8926        564        640: 100%|██████████| 405/405 [01:33<00:00,  4.35it/s]
                 Class     Images  Instances      Box(P          R      mAP50  mAP50-95): 100%|██████████| 18/18 [00:04<00:00,  4.26it/s]
                   all        548      38759      0.498      0.375      0.385      0.229
  0%|          | 0/405 [00:00<?, ?it/s]
      Epoch    GPU_mem   box_loss   cls_loss   dfl_loss  Instances       Size
      35/80      8.53G      1.248     0.8422     0.8925        498        640: 100%|██████████| 405/405 [01:33<00:00,  4.34it/s]
                 Class     Images  Instances      Box(P          R      mAP50  mAP50-95): 100%|██████████| 18/18 [00:04<00:00,  4.26it/s]
                   all        548      38759      0.492      0.377      0.385      0.229
  0%|          | 0/405 [00:00<?, ?it/s]
      Epoch    GPU_mem   box_loss   cls_loss   dfl_loss  Instances       Size
      36/80      7.49G      1.241     0.8365     0.8903        587        640: 100%|██████████| 405/405 [01:33<00:00,  4.35it/s]
                 Class     Images  Instances      Box(P          R      mAP50  mAP50-95): 100%|██████████| 18/18 [00:04<00:00,  4.24it/s]
                   all        548      38759      0.497      0.372      0.384      0.227

      Epoch    GPU_mem   box_loss   cls_loss   dfl_loss  Instances       Size
      37/80      10.4G      1.243     0.8382       0.89        634        640: 100%|██████████| 405/405 [01:33<00:00,  4.34it/s]
                 Class     Images  Instances      Box(P          R      mAP50  mAP50-95): 100%|██████████| 18/18 [00:04<00:00,  4.31it/s]
                   all        548      38759        0.5      0.381      0.392      0.232
  0%|          | 0/405 [00:00<?, ?it/s]
      Epoch    GPU_mem   box_loss   cls_loss   dfl_loss  Instances       Size
      38/80      9.81G      1.237     0.8309     0.8893        701        640: 100%|██████████| 405/405 [01:33<00:00,  4.35it/s]
                 Class     Images  Instances      Box(P          R      mAP50  mAP50-95): 100%|██████████| 18/18 [00:04<00:00,  4.28it/s]
                   all        548      38759        0.5      0.376      0.385      0.228
  0%|          | 0/405 [00:00<?, ?it/s]
      Epoch    GPU_mem   box_loss   cls_loss   dfl_loss  Instances       Size
      39/80      8.61G      1.245     0.8318     0.8889        604        640: 100%|██████████| 405/405 [01:33<00:00,  4.34it/s]
                 Class     Images  Instances      Box(P          R      mAP50  mAP50-95): 100%|██████████| 18/18 [00:04<00:00,  4.27it/s]
                   all        548      38759      0.498      0.374      0.387      0.229
  0%|          | 0/405 [00:00<?, ?it/s]
      Epoch    GPU_mem   box_loss   cls_loss   dfl_loss  Instances       Size
      40/80      9.85G      1.237     0.8267       0.89        691        640: 100%|██████████| 405/405 [01:32<00:00,  4.36it/s]
                 Class     Images  Instances      Box(P          R      mAP50  mAP50-95): 100%|██████████| 18/18 [00:04<00:00,  4.23it/s]
                   all        548      38759      0.498      0.378      0.387      0.229
  0%|          | 0/405 [00:00<?, ?it/s]
      Epoch    GPU_mem   box_loss   cls_loss   dfl_loss  Instances       Size
      41/80      10.9G      1.231     0.8183     0.8874        554        640: 100%|██████████| 405/405 [01:32<00:00,  4.36it/s]
                 Class     Images  Instances      Box(P          R      mAP50  mAP50-95): 100%|██████████| 18/18 [00:04<00:00,  4.30it/s]
                   all        548      38759      0.492      0.384      0.389       0.23
  0%|          | 0/405 [00:00<?, ?it/s]
      Epoch    GPU_mem   box_loss   cls_loss   dfl_loss  Instances       Size
      42/80      9.49G      1.227     0.8149     0.8865        353        640: 100%|██████████| 405/405 [01:33<00:00,  4.34it/s]
                 Class     Images  Instances      Box(P          R      mAP50  mAP50-95): 100%|██████████| 18/18 [00:04<00:00,  4.25it/s]
                   all        548      38759      0.502      0.375      0.388       0.23

      Epoch    GPU_mem   box_loss   cls_loss   dfl_loss  Instances       Size
      43/80      8.84G      1.226     0.8167     0.8859        446        640: 100%|██████████| 405/405 [01:33<00:00,  4.35it/s]
                 Class     Images  Instances      Box(P          R      mAP50  mAP50-95): 100%|██████████| 18/18 [00:04<00:00,  4.28it/s]
                   all        548      38759      0.494      0.379      0.387      0.229

      Epoch    GPU_mem   box_loss   cls_loss   dfl_loss  Instances       Size
      44/80      8.82G      1.221     0.8077     0.8844        957        640: 100%|██████████| 405/405 [01:32<00:00,  4.36it/s]
                 Class     Images  Instances      Box(P          R      mAP50  mAP50-95): 100%|██████████| 18/18 [00:04<00:00,  4.24it/s]
                   all        548      38759      0.487      0.383      0.391      0.232
  0%|          | 0/405 [00:00<?, ?it/s]
      Epoch    GPU_mem   box_loss   cls_loss   dfl_loss  Instances       Size
      45/80      9.22G      1.218     0.8035     0.8844        568        640: 100%|██████████| 405/405 [01:32<00:00,  4.36it/s]
                 Class     Images  Instances      Box(P          R      mAP50  mAP50-95): 100%|██████████| 18/18 [00:04<00:00,  4.24it/s]
                   all        548      38759      0.485      0.385       0.39      0.232

      Epoch    GPU_mem   box_loss   cls_loss   dfl_loss  Instances       Size
      46/80      10.1G      1.214     0.7988     0.8837        506        640: 100%|██████████| 405/405 [01:33<00:00,  4.35it/s]
                 Class     Images  Instances      Box(P          R      mAP50  mAP50-95): 100%|██████████| 18/18 [00:04<00:00,  4.29it/s]
                   all        548      38759      0.491      0.384       0.39      0.232
  0%|          | 0/405 [00:00<?, ?it/s]
      Epoch    GPU_mem   box_loss   cls_loss   dfl_loss  Instances       Size
      47/80      13.2G      1.214     0.7962     0.8843        616        640: 100%|██████████| 405/405 [01:39<00:00,  4.05it/s]
                 Class     Images  Instances      Box(P          R      mAP50  mAP50-95): 100%|██████████| 18/18 [00:04<00:00,  4.27it/s]
                   all        548      38759      0.484      0.386      0.388       0.23
  0%|          | 0/405 [00:00<?, ?it/s]
      Epoch    GPU_mem   box_loss   cls_loss   dfl_loss  Instances       Size
      48/80      12.1G      1.214     0.7956     0.8845       1312        640: 100%|██████████| 405/405 [01:37<00:00,  4.16it/s]
                 Class     Images  Instances      Box(P          R      mAP50  mAP50-95): 100%|██████████| 18/18 [00:04<00:00,  4.34it/s]
                   all        548      38759      0.498      0.381      0.391      0.231

      Epoch    GPU_mem   box_loss   cls_loss   dfl_loss  Instances       Size
      49/80      10.9G       1.21     0.7897     0.8833        588        640: 100%|██████████| 405/405 [01:33<00:00,  4.35it/s]
                 Class     Images  Instances      Box(P          R      mAP50  mAP50-95): 100%|██████████| 18/18 [00:04<00:00,  4.32it/s]
                   all        548      38759      0.495      0.379      0.391      0.232

      Epoch    GPU_mem   box_loss   cls_loss   dfl_loss  Instances       Size
      50/80      10.7G      1.208     0.7851     0.8831        434        640: 100%|██████████| 405/405 [01:33<00:00,  4.34it/s]
                 Class     Images  Instances      Box(P          R      mAP50  mAP50-95): 100%|██████████| 18/18 [00:04<00:00,  4.26it/s]
                   all        548      38759      0.504       0.38      0.392      0.233
  0%|          | 0/405 [00:00<?, ?it/s]
      Epoch    GPU_mem   box_loss   cls_loss   dfl_loss  Instances       Size
      51/80      10.4G      1.209     0.7861     0.8816        673        640: 100%|██████████| 405/405 [01:33<00:00,  4.34it/s]
                 Class     Images  Instances      Box(P          R      mAP50  mAP50-95): 100%|██████████| 18/18 [00:04<00:00,  4.25it/s]
                   all        548      38759      0.498       0.38      0.391      0.231
  0%|          | 0/405 [00:00<?, ?it/s]
      Epoch    GPU_mem   box_loss   cls_loss   dfl_loss  Instances       Size
      52/80      12.2G        1.2     0.7801     0.8825        436        640: 100%|██████████| 405/405 [01:36<00:00,  4.22it/s]
                 Class     Images  Instances      Box(P          R      mAP50  mAP50-95): 100%|██████████| 18/18 [00:04<00:00,  4.28it/s]
                   all        548      38759      0.486      0.387      0.392      0.232
  0%|          | 0/405 [00:00<?, ?it/s]
      Epoch    GPU_mem   box_loss   cls_loss   dfl_loss  Instances       Size
      53/80      10.3G      1.202     0.7788     0.8812        593        640: 100%|██████████| 405/405 [01:33<00:00,  4.34it/s]
                 Class     Images  Instances      Box(P          R      mAP50  mAP50-95): 100%|██████████| 18/18 [00:04<00:00,  4.32it/s]
                   all        548      38759      0.512      0.378      0.393      0.233

      Epoch    GPU_mem   box_loss   cls_loss   dfl_loss  Instances       Size
      54/80      12.1G      1.196     0.7726     0.8799        618        640: 100%|██████████| 405/405 [02:27<00:00,  2.74it/s]
                 Class     Images  Instances      Box(P          R      mAP50  mAP50-95): 100%|██████████| 18/18 [00:06<00:00,  2.69it/s]
                   all        548      38759      0.509      0.382      0.393      0.231
  0%|          | 0/405 [00:00<?, ?it/s]
      Epoch    GPU_mem   box_loss   cls_loss   dfl_loss  Instances       Size
      55/80      7.17G      1.189      0.766     0.8791        846        640: 100%|██████████| 405/405 [01:32<00:00,  4.36it/s]
                 Class     Images  Instances      Box(P          R      mAP50  mAP50-95): 100%|██████████| 18/18 [00:04<00:00,  4.31it/s]
                   all        548      38759      0.497      0.388      0.395      0.234
  0%|          | 0/405 [00:00<?, ?it/s]
      Epoch    GPU_mem   box_loss   cls_loss   dfl_loss  Instances       Size
      56/80      8.16G      1.191     0.7663     0.8789        822        640: 100%|██████████| 405/405 [01:32<00:00,  4.36it/s]
                 Class     Images  Instances      Box(P          R      mAP50  mAP50-95): 100%|██████████| 18/18 [00:04<00:00,  4.31it/s]
                   all        548      38759      0.504      0.382      0.392      0.233

      Epoch    GPU_mem   box_loss   cls_loss   dfl_loss  Instances       Size
      57/80       8.6G      1.194     0.7641     0.8793        709        640: 100%|██████████| 405/405 [01:33<00:00,  4.33it/s]
                 Class     Images  Instances      Box(P          R      mAP50  mAP50-95): 100%|██████████| 18/18 [00:04<00:00,  4.31it/s]
                   all        548      38759      0.504      0.385      0.393      0.233
  0%|          | 0/405 [00:00<?, ?it/s]
      Epoch    GPU_mem   box_loss   cls_loss   dfl_loss  Instances       Size
      58/80      7.88G      1.185     0.7569     0.8778        442        640: 100%|██████████| 405/405 [01:33<00:00,  4.35it/s]
                 Class     Images  Instances      Box(P          R      mAP50  mAP50-95): 100%|██████████| 18/18 [00:04<00:00,  4.28it/s]
                   all        548      38759      0.501      0.387      0.393      0.233
  0%|          | 0/405 [00:00<?, ?it/s]
      Epoch    GPU_mem   box_loss   cls_loss   dfl_loss  Instances       Size
      59/80      9.32G      1.183     0.7544     0.8774        438        640: 100%|██████████| 405/405 [01:32<00:00,  4.38it/s]
                 Class     Images  Instances      Box(P          R      mAP50  mAP50-95): 100%|██████████| 18/18 [00:04<00:00,  4.26it/s]
                   all        548      38759      0.502      0.386      0.393      0.234
  0%|          | 0/405 [00:00<?, ?it/s]
      Epoch    GPU_mem   box_loss   cls_loss   dfl_loss  Instances       Size
      60/80      9.23G       1.18      0.751     0.8758        747        640: 100%|██████████| 405/405 [01:33<00:00,  4.34it/s]
                 Class     Images  Instances      Box(P          R      mAP50  mAP50-95): 100%|██████████| 18/18 [00:04<00:00,  4.28it/s]
                   all        548      38759      0.508       0.39      0.396      0.236
  0%|          | 0/405 [00:00<?, ?it/s]
      Epoch    GPU_mem   box_loss   cls_loss   dfl_loss  Instances       Size
      61/80        12G      1.178     0.7461     0.8762        627        640: 100%|██████████| 405/405 [01:35<00:00,  4.25it/s]
                 Class     Images  Instances      Box(P          R      mAP50  mAP50-95): 100%|██████████| 18/18 [00:04<00:00,  4.30it/s]
                   all        548      38759      0.511      0.383      0.396      0.235
  0%|          | 0/405 [00:00<?, ?it/s]
      Epoch    GPU_mem   box_loss   cls_loss   dfl_loss  Instances       Size
      62/80      12.2G      1.178     0.7471     0.8773        521        640: 100%|██████████| 405/405 [01:35<00:00,  4.24it/s]
                 Class     Images  Instances      Box(P          R      mAP50  mAP50-95): 100%|██████████| 18/18 [00:04<00:00,  4.36it/s]
                   all        548      38759        0.5      0.388      0.394      0.234
  0%|          | 0/405 [00:00<?, ?it/s]
      Epoch    GPU_mem   box_loss   cls_loss   dfl_loss  Instances       Size
      63/80      9.46G      1.173     0.7435     0.8744        427        640: 100%|██████████| 405/405 [01:33<00:00,  4.34it/s]
                 Class     Images  Instances      Box(P          R      mAP50  mAP50-95): 100%|██████████| 18/18 [00:04<00:00,  4.28it/s]
                   all        548      38759      0.503      0.385      0.394      0.233

      Epoch    GPU_mem   box_loss   cls_loss   dfl_loss  Instances       Size
      64/80      8.46G      1.173     0.7368     0.8756        389        640: 100%|██████████| 405/405 [01:32<00:00,  4.36it/s]
                 Class     Images  Instances      Box(P          R      mAP50  mAP50-95): 100%|██████████| 18/18 [00:04<00:00,  4.35it/s]
                   all        548      38759      0.511      0.385      0.395      0.233
  0%|          | 0/405 [00:00<?, ?it/s]
      Epoch    GPU_mem   box_loss   cls_loss   dfl_loss  Instances       Size
      65/80      6.55G      1.169     0.7365     0.8748        550        640: 100%|██████████| 405/405 [01:32<00:00,  4.36it/s]
                 Class     Images  Instances      Box(P          R      mAP50  mAP50-95): 100%|██████████| 18/18 [00:04<00:00,  4.33it/s]
                   all        548      38759      0.494      0.389      0.393      0.233
  0%|          | 0/405 [00:00<?, ?it/s]
      Epoch    GPU_mem   box_loss   cls_loss   dfl_loss  Instances       Size
      66/80      8.43G      1.172     0.7366     0.8746        704        640: 100%|██████████| 405/405 [01:33<00:00,  4.34it/s]
                 Class     Images  Instances      Box(P          R      mAP50  mAP50-95): 100%|██████████| 18/18 [00:04<00:00,  4.28it/s]
                   all        548      38759      0.504      0.379      0.394      0.233

      Epoch    GPU_mem   box_loss   cls_loss   dfl_loss  Instances       Size
      67/80      7.34G      1.164       0.73     0.8738        413        640: 100%|██████████| 405/405 [01:32<00:00,  4.37it/s]
                 Class     Images  Instances      Box(P          R      mAP50  mAP50-95): 100%|██████████| 18/18 [00:04<00:00,  4.29it/s]
                   all        548      38759      0.499       0.38      0.393      0.232
  0%|          | 0/405 [00:00<?, ?it/s]
      Epoch    GPU_mem   box_loss   cls_loss   dfl_loss  Instances       Size
      68/80      9.56G      1.166     0.7258     0.8733        499        640: 100%|██████████| 405/405 [01:33<00:00,  4.34it/s]
                 Class     Images  Instances      Box(P          R      mAP50  mAP50-95): 100%|██████████| 18/18 [00:04<00:00,  4.29it/s]
                   all        548      38759      0.493      0.385      0.394      0.232
  0%|          | 0/405 [00:00<?, ?it/s]
      Epoch    GPU_mem   box_loss   cls_loss   dfl_loss  Instances       Size
      69/80      9.95G      1.162     0.7246     0.8724        691        640: 100%|██████████| 405/405 [01:33<00:00,  4.34it/s]
                 Class     Images  Instances      Box(P          R      mAP50  mAP50-95): 100%|██████████| 18/18 [00:04<00:00,  4.30it/s]
                   all        548      38759      0.506      0.385      0.396      0.234

      Epoch    GPU_mem   box_loss   cls_loss   dfl_loss  Instances       Size
      70/80      7.82G      1.152     0.7175     0.8715        596        640: 100%|██████████| 405/405 [01:32<00:00,  4.37it/s]
                 Class     Images  Instances      Box(P          R      mAP50  mAP50-95): 100%|██████████| 18/18 [00:04<00:00,  4.30it/s]
                   all        548      38759        0.5      0.383      0.395      0.235
Closing dataloader mosaic
  0%|          | 0/405 [00:00<?, ?it/s]
      Epoch    GPU_mem   box_loss   cls_loss   dfl_loss  Instances       Size
      71/80      10.1G      1.139     0.7015     0.8726        439        640: 100%|██████████| 405/405 [01:28<00:00,  4.58it/s]
                 Class     Images  Instances      Box(P          R      mAP50  mAP50-95): 100%|██████████| 18/18 [00:04<00:00,  4.35it/s]
                   all        548      38759      0.504      0.376      0.392      0.233

      Epoch    GPU_mem   box_loss   cls_loss   dfl_loss  Instances       Size
      72/80      9.21G      1.134     0.6939     0.8703        345        640: 100%|██████████| 405/405 [01:27<00:00,  4.61it/s]
                 Class     Images  Instances      Box(P          R      mAP50  mAP50-95): 100%|██████████| 18/18 [00:04<00:00,  4.28it/s]
                   all        548      38759      0.508      0.378      0.392      0.232
  0%|          | 0/405 [00:00<?, ?it/s]
      Epoch    GPU_mem   box_loss   cls_loss   dfl_loss  Instances       Size
      73/80      11.9G      1.126     0.6842     0.8695        252        640: 100%|██████████| 405/405 [01:29<00:00,  4.53it/s]
                 Class     Images  Instances      Box(P          R      mAP50  mAP50-95): 100%|██████████| 18/18 [00:04<00:00,  4.30it/s]
                   all        548      38759      0.499      0.383      0.392      0.232
  0%|          | 0/405 [00:00<?, ?it/s]
      Epoch    GPU_mem   box_loss   cls_loss   dfl_loss  Instances       Size
      74/80      10.6G      1.123     0.6812     0.8702        187        640: 100%|██████████| 405/405 [01:28<00:00,  4.60it/s]
                 Class     Images  Instances      Box(P          R      mAP50  mAP50-95): 100%|██████████| 18/18 [00:04<00:00,  4.32it/s]
                   all        548      38759      0.506      0.378      0.392      0.232

      Epoch    GPU_mem   box_loss   cls_loss   dfl_loss  Instances       Size
      75/80      9.39G      1.117     0.6748     0.8673        308        640: 100%|██████████| 405/405 [01:27<00:00,  4.62it/s]
                 Class     Images  Instances      Box(P          R      mAP50  mAP50-95): 100%|██████████| 18/18 [00:04<00:00,  4.33it/s]
                   all        548      38759      0.502       0.38      0.393      0.232

      Epoch    GPU_mem   box_loss   cls_loss   dfl_loss  Instances       Size
      76/80        10G      1.118     0.6742     0.8675        467        640: 100%|██████████| 405/405 [01:27<00:00,  4.61it/s]
                 Class     Images  Instances      Box(P          R      mAP50  mAP50-95): 100%|██████████| 18/18 [00:04<00:00,  4.28it/s]
                   all        548      38759      0.504      0.378      0.393      0.232
  0%|          | 0/405 [00:00<?, ?it/s]
      Epoch    GPU_mem   box_loss   cls_loss   dfl_loss  Instances       Size
      77/80      8.48G      1.113     0.6707     0.8676        491        640: 100%|██████████| 405/405 [01:27<00:00,  4.61it/s]
                 Class     Images  Instances      Box(P          R      mAP50  mAP50-95): 100%|██████████| 18/18 [00:04<00:00,  4.32it/s]
                   all        548      38759      0.502      0.379      0.392      0.232

      Epoch    GPU_mem   box_loss   cls_loss   dfl_loss  Instances       Size
      78/80      9.27G      1.113     0.6702     0.8669        374        640: 100%|██████████| 405/405 [01:27<00:00,  4.61it/s]
                 Class     Images  Instances      Box(P          R      mAP50  mAP50-95): 100%|██████████| 18/18 [00:04<00:00,  4.30it/s]
                   all        548      38759      0.499      0.381      0.393      0.232

      Epoch    GPU_mem   box_loss   cls_loss   dfl_loss  Instances       Size
      79/80      8.02G      1.111     0.6649     0.8661        571        640: 100%|██████████| 405/405 [01:27<00:00,  4.61it/s]
                 Class     Images  Instances      Box(P          R      mAP50  mAP50-95): 100%|██████████| 18/18 [00:04<00:00,  4.32it/s]
                   all        548      38759      0.504      0.379      0.393      0.232
  0%|          | 0/405 [00:00<?, ?it/s]
      Epoch    GPU_mem   box_loss   cls_loss   dfl_loss  Instances       Size
      80/80      8.29G      1.113      0.667     0.8653        324        640: 100%|██████████| 405/405 [01:27<00:00,  4.62it/s]
                 Class     Images  Instances      Box(P          R      mAP50  mAP50-95): 100%|██████████| 18/18 [00:04<00:00,  4.32it/s]
                   all        548      38759      0.505      0.379      0.393      0.232
EarlyStopping: Training stopped early as no improvement observed in last 20 epochs. Best results observed at epoch 60, best model saved as best.pt.
To update EarlyStopping(patience=20) pass a new patience value, i.e. `patience=300` or use `patience=0` to disable EarlyStopping.

80 epochs completed in 2.189 hours.
Optimizer stripped from D:\Project\VisDrone_Experiment\runs\full\weights\last.pt, 22.5MB
Optimizer stripped from D:\Project\VisDrone_Experiment\runs\full\weights\best.pt, 22.5MB

Validating D:\Project\VisDrone_Experiment\runs\full\weights\best.pt...
Ultralytics 8.3.146  Python-3.9.13 torch-2.2.2+cu118 CUDA:0 (NVIDIA GeForce RTX 3060, 12288MiB)
Model summary (fused): 72 layers, 11,129,454 parameters, 0 gradients, 28.5 GFLOPs
                 Class     Images  Instances      Box(P          R      mAP50  mAP50-95): 100%|██████████| 18/18 [00:13<00:00,  1.32it/s]
                   all        548      38759      0.507       0.39      0.396      0.236
Speed: 0.1ms preprocess, 2.4ms inference, 0.0ms loss, 1.4ms postprocess per image
Results saved to D:\Project\VisDrone_Experiment\runs\full
🧹 清理hook完成
✅ 训练完成
开始评估...
Ultralytics 8.3.146  Python-3.9.13 torch-2.2.2+cu118 CUDA:0 (NVIDIA GeForce RTX 3060, 12288MiB)
Model summary (fused): 72 layers, 11,129,454 parameters, 0 gradients, 28.5 GFLOPs
val: Fast image access  (ping: 0.10.0 ms, read: 1189.5294.9 MB/s, size: 153.1 KB)
val: Scanning D:\Project\VisDrone_Experiment\VisDrone2019-DET\labels\val.cache... 548 images, 0 backgrounds, 0 corrupt: 100%|██████████| 548/548 [00:00<?, ?it/s]
                 Class     Images  Instances      Box(P          R      mAP50  mAP50-95): 100%|██████████| 35/35 [00:15<00:00,  2.20it/s]
                   all        548      38759      0.517      0.395      0.402      0.237
Speed: 0.3ms preprocess, 5.1ms inference, 0.0ms loss, 4.7ms postprocess per image
Results saved to D:\VoiceRecognition\VoiceprintRecognition-Pytorch\runs\detect\val4
❌ 评估失败: 'Metric' object has no attribute 'precision'. See valid attributes below.

    Class for computing evaluation metrics for Ultralytics YOLO models.

    Attributes:
        p (list): Precision for each class. Shape: (nc,).
        r (list): Recall for each class. Shape: (nc,).
        f1 (list): F1 score for each class. Shape: (nc,).
        all_ap (list): AP scores for all classes and all IoU thresholds. Shape: (nc, 10).
        ap_class_index (list): Index of class for each AP score. Shape: (nc,).
        nc (int): Number of classes.

    Methods:
        ap50(): AP at IoU threshold of 0.5 for all classes. Returns: List of AP scores. Shape: (nc,) or [].
        ap(): AP at IoU thresholds from 0.5 to 0.95 for all classes. Returns: List of AP scores. Shape: (nc,) or [].
        mp(): Mean precision of all classes. Returns: Float.
        mr(): Mean recall of all classes. Returns: Float.
        map50(): Mean AP at IoU threshold of 0.5 for all classes. Returns: Float.
        map75(): Mean AP at IoU threshold of 0.75 for all classes. Returns: Float.
        map(): Mean AP at IoU thresholds from 0.5 to 0.95 for all classes. Returns: Float.
        mean_results(): Mean of results, returns mp, mr, map50, map.
        class_result(i): Class-aware result, returns p[i], r[i], ap50[i], ap[i].
        maps(): mAP of each class. Returns: Array of mAP scores, shape: (nc,).
        fitness(): Model fitness as a weighted combination of metrics. Returns: Float.
        update(results): Update metric attributes with new evaluation results.


📊 实验结果分析
============================================================
❌ 没有成功的实验

🎯 消融实验完成!

Process finished with exit code 0
